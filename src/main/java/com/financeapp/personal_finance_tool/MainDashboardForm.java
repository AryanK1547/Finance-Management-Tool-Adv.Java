/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/GUIForms/JFrame.java to edit this template
 */
package com.financeapp.personal_finance_tool;
import org.jfree.chart.*;
import com.itextpdf.text.Document;
import com.itextpdf.text.pdf.PdfWriter;
import com.itextpdf.text.Image;
import com.itextpdf.text.Rectangle;  // iText's Rectangle
import org.jfree.chart.JFreeChart;
import org.jfree.chart.ChartPanel;
import org.jfree.chart.plot.PlotOrientation;
import org.jfree.data.category.DefaultCategoryDataset;
import javax.swing.*;
import java.awt.*;
import java.awt.image.BufferedImage;
import java.io.FileOutputStream;
import java.util.Map;

import com.formdev.flatlaf.FlatLightLaf;
import com.formdev.flatlaf.themes.FlatMacDarkLaf;
import com.itextpdf.awt.geom.Rectangle2D;
import com.itextpdf.text.Chunk;
import com.itextpdf.text.Document;
import com.itextpdf.text.DocumentException;
import com.itextpdf.text.Element;
import com.itextpdf.text.FontFactory;
import com.itextpdf.text.Paragraph;
import com.itextpdf.text.pdf.PdfPTable;
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Dimension;
import java.awt.Font;
import java.awt.Graphics2D;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.io.File;
import java.io.IOException;
import java.sql.Connection;
import java.sql.Date;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.text.SimpleDateFormat;
import java.time.LocalDate;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.LinkedHashMap;
import java.util.List;
import java.util.Map;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.BorderFactory;
import javax.swing.JComboBox;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.JTable;
import javax.swing.SwingWorker;
import javax.swing.table.DefaultTableModel;
import org.jfree.chart.plot.CategoryPlot;
import org.jfree.chart.plot.PiePlot;
import org.jfree.chart.plot.PlotOrientation;
import org.jfree.data.category.DefaultCategoryDataset;
import org.jfree.data.general.DefaultPieDataset;
import raven.datetime.component.date.DatePicker;


/**
 *
 * @author user
 */
public class MainDashboardForm extends javax.swing.JFrame {
 private int selectedAnalyzeYear;
private String selectedAnalyzeCategory;

     private String loggedusername;
    private int userId;
     private User user;
    private TransactionDAO transactionDAO;
    private JFrame frame;
    public static int loggedInUserId = -1; 

    /**
     * Creates new form MainDashboardForm
     */
    public MainDashboardForm(String loggedusername, int userId) {
       this.loggedusername = loggedusername;
    this.userId = userId; // Assign userId correctly

    this.loggedInUserId = UserSession.getInstance().getUserId();
    transactionDAO = new TransactionDAO(); // Initialize transactionDAO
    initComponents();  // Initialize components before calling populateYearComboBox

    // Now, populate the year combo box after initializing transactionDAO
    String url = "jdbc:mysql://localhost:3306/personal_finance";
    String username = "root";
    String password = "mysql";
    updateUserInfo();
      populateYearComboBox(url,username,password,cbViewYearFilter);
    populateMonthComboBox(url,username,password,cbViewMonth);
    populateDayComboBox(url,username,password,cbViewDay);
      populateYearComboBox(url,username,password,cbUpdateYearFilter);
    populateMonthComboBox(url,username,password,cbUpdateMonth);
    populateDayComboBox(url,username,password,cbUpdateDay);
     populateYearComboBox(url,username,password,cbRemoveYearFilter);
    populateMonthComboBox(url,username,password,cbRemoveMonth);
    populateDayComboBox(url,username,password,cbRemoveDay);
     populateYearComboBox(url,username,password,cbAnalyzeYear);
    }

   

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        ButtonPanel = new javax.swing.JPanel();
        btnShowTransactionModule = new javax.swing.JButton();
        btnAnayliticsPanel = new javax.swing.JButton();
        btnGenerateReport = new javax.swing.JButton();
        btnAboutSoftwareandCreatorVision = new javax.swing.JButton();
        NavigationPanel = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();
        btnLogoutSession = new javax.swing.JButton();
        jLabel2 = new javax.swing.JLabel();
        txtUserName = new javax.swing.JLabel();
        txtUserID = new javax.swing.JLabel();
        mainPanel = new javax.swing.JPanel();
        WelcomePanel = new javax.swing.JPanel();
        jLabel14 = new javax.swing.JLabel();
        TransactionPanel = new javax.swing.JPanel();
        TransactionModulesPanel = new javax.swing.JPanel();
        WelcomePanelTrancationiModule = new javax.swing.JPanel();
        jLabel13 = new javax.swing.JLabel();
        AddTransactionPanel = new javax.swing.JPanel();
        jLabel7 = new javax.swing.JLabel();
        jLabel8 = new javax.swing.JLabel();
        jLabel12 = new javax.swing.JLabel();
        jLabel9 = new javax.swing.JLabel();
        jLabel10 = new javax.swing.JLabel();
        jLabel11 = new javax.swing.JLabel();
        txtAddAmount = new javax.swing.JTextField();
        btnAddTransaction = new javax.swing.JButton();
        jLabel5 = new javax.swing.JLabel();
        jLabel6 = new javax.swing.JLabel();
        txtAddDatePicked = new javax.swing.JFormattedTextField();
        jScrollPane2 = new javax.swing.JScrollPane();
        txtAddDescription = new javax.swing.JTextArea();
        cbAddCategory = new javax.swing.JComboBox<>();
        ViewTransactionPanel = new javax.swing.JPanel();
        jLabel15 = new javax.swing.JLabel();
        jLabel16 = new javax.swing.JLabel();
        jScrollPane1 = new javax.swing.JScrollPane();
        tabelViewAllTransactions = new javax.swing.JTable();
        jLabel3 = new javax.swing.JLabel();
        cbViewYearFilter = new javax.swing.JComboBox<>();
        jLabel17 = new javax.swing.JLabel();
        cbViewMonth = new javax.swing.JComboBox<>();
        jLabel18 = new javax.swing.JLabel();
        cbViewDay = new javax.swing.JComboBox<>();
        cbViewCategoryFilter = new javax.swing.JComboBox<>();
        jLabel19 = new javax.swing.JLabel();
        jButton1 = new javax.swing.JButton();
        UpdateTransactionsPanel = new javax.swing.JPanel();
        jLabel20 = new javax.swing.JLabel();
        jLabel21 = new javax.swing.JLabel();
        jLabel22 = new javax.swing.JLabel();
        jLabel23 = new javax.swing.JLabel();
        cbUpdateYearFilter = new javax.swing.JComboBox<>();
        cbUpdateMonth = new javax.swing.JComboBox<>();
        cbUpdateDay = new javax.swing.JComboBox<>();
        cbUpdateCategoryFilter = new javax.swing.JComboBox<>();
        jLabel24 = new javax.swing.JLabel();
        jLabel25 = new javax.swing.JLabel();
        jScrollPane3 = new javax.swing.JScrollPane();
        tabelUpdateTransactions = new javax.swing.JTable();
        jLabel32 = new javax.swing.JLabel();
        txtUpdateAmount = new javax.swing.JTextField();
        jLabel33 = new javax.swing.JLabel();
        txtUpdateDate = new javax.swing.JFormattedTextField();
        jLabel34 = new javax.swing.JLabel();
        jScrollPane5 = new javax.swing.JScrollPane();
        txtUpdateDescription = new javax.swing.JTextArea();
        jLabel35 = new javax.swing.JLabel();
        cbUpdateCategory = new javax.swing.JComboBox<>();
        btnUpdateTransaction = new javax.swing.JButton();
        RemoveTransactionPanel = new javax.swing.JPanel();
        btnRemoveTransaction = new javax.swing.JButton();
        jLabel36 = new javax.swing.JLabel();
        jLabel26 = new javax.swing.JLabel();
        txtRemoveAmount = new javax.swing.JTextField();
        cbRemoveYearFilter = new javax.swing.JComboBox<>();
        jLabel37 = new javax.swing.JLabel();
        cbRemoveMonth = new javax.swing.JComboBox<>();
        txtRemoveDate = new javax.swing.JFormattedTextField();
        cbRemoveDay = new javax.swing.JComboBox<>();
        jLabel38 = new javax.swing.JLabel();
        cbRemoveCategoryFilter = new javax.swing.JComboBox<>();
        jScrollPane6 = new javax.swing.JScrollPane();
        txtRemoveDescription = new javax.swing.JTextArea();
        jLabel27 = new javax.swing.JLabel();
        jLabel28 = new javax.swing.JLabel();
        jLabel39 = new javax.swing.JLabel();
        jScrollPane4 = new javax.swing.JScrollPane();
        tabelRemoveTransactions = new javax.swing.JTable();
        cbRemoveCategory = new javax.swing.JComboBox<>();
        jLabel29 = new javax.swing.JLabel();
        jLabel30 = new javax.swing.JLabel();
        jLabel31 = new javax.swing.JLabel();
        TrascationChoicePanel = new javax.swing.JPanel();
        jLabel4 = new javax.swing.JLabel();
        btnAddTransactionModule = new javax.swing.JButton();
        btnViewTransactionModule = new javax.swing.JButton();
        btnUpdateTransactionPanel = new javax.swing.JButton();
        btnRemoveTransactionModule = new javax.swing.JButton();
        AnalyticsPanel = new javax.swing.JPanel();
        AnalyticsNavigationPanel = new javax.swing.JPanel();
        cbAnalyzeYear = new javax.swing.JComboBox<>();
        cbAnalyzeCategory = new javax.swing.JComboBox<>();
        btnAnalyzeGenerateReport = new javax.swing.JButton();
        btnGeneratePieChart = new javax.swing.JButton();
        ChartDisplayPanel = new javax.swing.JPanel();
        WelcomeAnalyticsPanel = new javax.swing.JPanel();
        jLabel40 = new javax.swing.JLabel();
        ProgressBarPanel = new javax.swing.JPanel();
        jLabel41 = new javax.swing.JLabel();
        pbAnaylyticsChartProgress = new javax.swing.JProgressBar();
        AnalyticsMainChartPanel = new javax.swing.JPanel();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

        btnShowTransactionModule.setBackground(new java.awt.Color(0, 153, 51));
        btnShowTransactionModule.setFont(new java.awt.Font("Segoe UI", 1, 18)); // NOI18N
        btnShowTransactionModule.setForeground(new java.awt.Color(255, 255, 255));
        btnShowTransactionModule.setText("Transaction");
        btnShowTransactionModule.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnShowTransactionModuleActionPerformed(evt);
            }
        });

        btnAnayliticsPanel.setBackground(new java.awt.Color(102, 102, 0));
        btnAnayliticsPanel.setFont(new java.awt.Font("Segoe UI", 1, 18)); // NOI18N
        btnAnayliticsPanel.setForeground(new java.awt.Color(255, 255, 255));
        btnAnayliticsPanel.setText("Analytics");
        btnAnayliticsPanel.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnAnayliticsPanelActionPerformed(evt);
            }
        });

        btnGenerateReport.setBackground(new java.awt.Color(0, 102, 102));
        btnGenerateReport.setFont(new java.awt.Font("Segoe UI", 1, 18)); // NOI18N
        btnGenerateReport.setForeground(new java.awt.Color(255, 255, 255));
        btnGenerateReport.setText("Generate Report");
        btnGenerateReport.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnGenerateReportActionPerformed(evt);
            }
        });

        btnAboutSoftwareandCreatorVision.setBackground(new java.awt.Color(153, 153, 153));
        btnAboutSoftwareandCreatorVision.setFont(new java.awt.Font("Segoe UI", 1, 18)); // NOI18N
        btnAboutSoftwareandCreatorVision.setForeground(new java.awt.Color(255, 255, 255));
        btnAboutSoftwareandCreatorVision.setText("About");
        btnAboutSoftwareandCreatorVision.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnAboutSoftwareandCreatorVisionActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout ButtonPanelLayout = new javax.swing.GroupLayout(ButtonPanel);
        ButtonPanel.setLayout(ButtonPanelLayout);
        ButtonPanelLayout.setHorizontalGroup(
            ButtonPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(ButtonPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(ButtonPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(btnAboutSoftwareandCreatorVision, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(btnAnayliticsPanel, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(btnShowTransactionModule, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addGroup(ButtonPanelLayout.createSequentialGroup()
                        .addComponent(btnGenerateReport, javax.swing.GroupLayout.PREFERRED_SIZE, 170, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 0, Short.MAX_VALUE)))
                .addContainerGap())
        );
        ButtonPanelLayout.setVerticalGroup(
            ButtonPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(ButtonPanelLayout.createSequentialGroup()
                .addGap(16, 16, 16)
                .addComponent(btnShowTransactionModule, javax.swing.GroupLayout.PREFERRED_SIZE, 69, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(65, 65, 65)
                .addComponent(btnAnayliticsPanel, javax.swing.GroupLayout.PREFERRED_SIZE, 69, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(btnGenerateReport, javax.swing.GroupLayout.PREFERRED_SIZE, 71, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(72, 72, 72)
                .addComponent(btnAboutSoftwareandCreatorVision, javax.swing.GroupLayout.PREFERRED_SIZE, 58, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(42, 42, 42))
        );

        NavigationPanel.setBackground(new java.awt.Color(0, 0, 0));
        NavigationPanel.setAlignmentY(0.0F);

        btnLogoutSession.setBackground(new java.awt.Color(255, 51, 51));
        btnLogoutSession.setForeground(new java.awt.Color(255, 255, 255));
        btnLogoutSession.setText("Logout");
        btnLogoutSession.setBorder(null);
        btnLogoutSession.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnLogoutSessionActionPerformed(evt);
            }
        });

        jLabel2.setFont(new java.awt.Font("Segoe UI", 1, 36)); // NOI18N
        jLabel2.setForeground(new java.awt.Color(255, 255, 255));
        jLabel2.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel2.setText("Finance Management Tool");
        jLabel2.setToolTipText("");
        jLabel2.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);

        txtUserName.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        txtUserName.setForeground(new java.awt.Color(0, 255, 51));
        txtUserName.setText("Username");

        txtUserID.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        txtUserID.setForeground(new java.awt.Color(0, 255, 0));
        txtUserID.setText("UserID ");

        javax.swing.GroupLayout NavigationPanelLayout = new javax.swing.GroupLayout(NavigationPanel);
        NavigationPanel.setLayout(NavigationPanelLayout);
        NavigationPanelLayout.setHorizontalGroup(
            NavigationPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(NavigationPanelLayout.createSequentialGroup()
                .addGap(19, 19, 19)
                .addComponent(btnLogoutSession, javax.swing.GroupLayout.PREFERRED_SIZE, 81, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(270, 270, 270)
                .addComponent(jLabel1)
                .addGap(89, 89, 89)
                .addComponent(jLabel2)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(txtUserID, javax.swing.GroupLayout.PREFERRED_SIZE, 91, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(txtUserName, javax.swing.GroupLayout.PREFERRED_SIZE, 167, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );
        NavigationPanelLayout.setVerticalGroup(
            NavigationPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(NavigationPanelLayout.createSequentialGroup()
                .addGroup(NavigationPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(NavigationPanelLayout.createSequentialGroup()
                        .addGap(1, 1, 1)
                        .addGroup(NavigationPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(txtUserName)
                            .addComponent(jLabel2)
                            .addComponent(txtUserID)))
                    .addGroup(NavigationPanelLayout.createSequentialGroup()
                        .addGap(22, 22, 22)
                        .addComponent(jLabel1))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, NavigationPanelLayout.createSequentialGroup()
                        .addContainerGap()
                        .addComponent(btnLogoutSession, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        mainPanel.setLayout(new java.awt.CardLayout());

        jLabel14.setFont(new java.awt.Font("Tw Cen MT Condensed Extra Bold", 0, 48)); // NOI18N
        jLabel14.setText("<html>Welcome To Finance Management Tool</html> ");

        javax.swing.GroupLayout WelcomePanelLayout = new javax.swing.GroupLayout(WelcomePanel);
        WelcomePanel.setLayout(WelcomePanelLayout);
        WelcomePanelLayout.setHorizontalGroup(
            WelcomePanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, WelcomePanelLayout.createSequentialGroup()
                .addContainerGap(133, Short.MAX_VALUE)
                .addComponent(jLabel14, javax.swing.GroupLayout.PREFERRED_SIZE, 952, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(68, 68, 68))
        );
        WelcomePanelLayout.setVerticalGroup(
            WelcomePanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(WelcomePanelLayout.createSequentialGroup()
                .addGap(99, 99, 99)
                .addComponent(jLabel14, javax.swing.GroupLayout.PREFERRED_SIZE, 290, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(153, Short.MAX_VALUE))
        );

        mainPanel.add(WelcomePanel, "card3");

        TransactionModulesPanel.setLayout(new java.awt.CardLayout());

        WelcomePanelTrancationiModule.setFont(new java.awt.Font("Segoe UI", 0, 24)); // NOI18N

        jLabel13.setFont(new java.awt.Font("Segoe UI", 0, 24)); // NOI18N
        jLabel13.setText("<html>\n<h1>Welcome to Trasaction Module: </h1>\n<p>Choose What to do from Above Options.</p></html>\n");
        jLabel13.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);

        javax.swing.GroupLayout WelcomePanelTrancationiModuleLayout = new javax.swing.GroupLayout(WelcomePanelTrancationiModule);
        WelcomePanelTrancationiModule.setLayout(WelcomePanelTrancationiModuleLayout);
        WelcomePanelTrancationiModuleLayout.setHorizontalGroup(
            WelcomePanelTrancationiModuleLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(WelcomePanelTrancationiModuleLayout.createSequentialGroup()
                .addComponent(jLabel13, javax.swing.GroupLayout.PREFERRED_SIZE, 986, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, Short.MAX_VALUE))
        );
        WelcomePanelTrancationiModuleLayout.setVerticalGroup(
            WelcomePanelTrancationiModuleLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(WelcomePanelTrancationiModuleLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel13, javax.swing.GroupLayout.PREFERRED_SIZE, 261, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        TransactionModulesPanel.add(WelcomePanelTrancationiModule, "card3");

        jLabel7.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        jLabel7.setText("Date Of Transaction: ");

        jLabel12.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        jLabel12.setText("Amount ");

        jLabel9.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        jLabel9.setText("Description");

        jLabel11.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        jLabel11.setText("Category: ");

        txtAddAmount.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N

        btnAddTransaction.setText("Add Transaction");
        btnAddTransaction.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnAddTransactionActionPerformed(evt);
            }
        });

        jLabel5.setFont(new java.awt.Font("Yu Gothic UI", 1, 14)); // NOI18N
        jLabel5.setText("Transaction Manager :");

        jLabel6.setText("Add Transaction Module");

        txtAddDatePicked.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtAddDatePickedActionPerformed(evt);
            }
        });
        DatePicker dp =new DatePicker();
        dp.setEditor(txtAddDatePicked);  // Link JFormattedTextField to DatePicker
        dp.setDateFormat("yyyy-MM-dd");  // Set date format for display
        dp.setUsePanelOption(true);  // Enable options panel on date picker
        dp.setCloseAfterSelected(true);  // Close popup after date selection
        dp.setSelectedDate(LocalDate.now());

        txtAddDescription.setColumns(20);
        txtAddDescription.setRows(5);
        jScrollPane2.setViewportView(txtAddDescription);

        cbAddCategory.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Item 1", "Item 2", "Item 3", "Item 4" }));
        cbAddCategory.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cbAddCategoryActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout AddTransactionPanelLayout = new javax.swing.GroupLayout(AddTransactionPanel);
        AddTransactionPanel.setLayout(AddTransactionPanelLayout);
        AddTransactionPanelLayout.setHorizontalGroup(
            AddTransactionPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(AddTransactionPanelLayout.createSequentialGroup()
                .addGap(14, 14, 14)
                .addGroup(AddTransactionPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(AddTransactionPanelLayout.createSequentialGroup()
                        .addComponent(jLabel5)
                        .addGap(18, 18, 18)
                        .addComponent(jLabel6, javax.swing.GroupLayout.PREFERRED_SIZE, 140, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                    .addGroup(AddTransactionPanelLayout.createSequentialGroup()
                        .addGroup(AddTransactionPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel7, javax.swing.GroupLayout.PREFERRED_SIZE, 190, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel12, javax.swing.GroupLayout.PREFERRED_SIZE, 135, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel9, javax.swing.GroupLayout.PREFERRED_SIZE, 121, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addGroup(AddTransactionPanelLayout.createSequentialGroup()
                                .addGap(127, 127, 127)
                                .addGroup(AddTransactionPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(jLabel10, javax.swing.GroupLayout.PREFERRED_SIZE, 43, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(jLabel8, javax.swing.GroupLayout.PREFERRED_SIZE, 37, javax.swing.GroupLayout.PREFERRED_SIZE)))
                            .addComponent(jLabel11, javax.swing.GroupLayout.PREFERRED_SIZE, 95, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(AddTransactionPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(cbAddCategory, 0, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(txtAddDatePicked, javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(jScrollPane2, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, 391, Short.MAX_VALUE)
                            .addComponent(txtAddAmount, javax.swing.GroupLayout.Alignment.TRAILING))
                        .addGap(54, 54, 54)
                        .addComponent(btnAddTransaction, javax.swing.GroupLayout.PREFERRED_SIZE, 172, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(304, 304, 304))))
        );
        AddTransactionPanelLayout.setVerticalGroup(
            AddTransactionPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(AddTransactionPanelLayout.createSequentialGroup()
                .addGap(11, 11, 11)
                .addGroup(AddTransactionPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel5, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel6))
                .addGap(18, 18, 18)
                .addGroup(AddTransactionPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel12)
                    .addComponent(txtAddAmount, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(22, 22, 22)
                .addGroup(AddTransactionPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel7)
                    .addComponent(txtAddDatePicked, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addComponent(jLabel8)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(AddTransactionPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(btnAddTransaction, javax.swing.GroupLayout.PREFERRED_SIZE, 105, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(AddTransactionPanelLayout.createSequentialGroup()
                        .addComponent(jLabel10)
                        .addGap(10, 10, 10)
                        .addGroup(AddTransactionPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel9)
                            .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))))
                .addGap(50, 50, 50)
                .addGroup(AddTransactionPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel11)
                    .addComponent(cbAddCategory, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(151, Short.MAX_VALUE))
        );

        TransactionModulesPanel.add(AddTransactionPanel, "card2");

        jLabel15.setFont(new java.awt.Font("Yu Gothic UI", 1, 14)); // NOI18N
        jLabel15.setText("Transaction Manager :");

        jLabel16.setText("View All Transactions Module");

        tabelViewAllTransactions.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null},
                {null, null, null, null, null},
                {null, null, null, null, null},
                {null, null, null, null, null}
            },
            new String [] {
                "TransactionID", "Category", "Amount", "Transaction Date", "Description"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        jScrollPane1.setViewportView(tabelViewAllTransactions);

        jLabel3.setText("Sort By Year:");

        cbViewYearFilter.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cbViewYearFilterActionPerformed(evt);
            }
        });

        jLabel17.setText("Sort By  Month:");

        cbViewMonth.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cbViewMonthActionPerformed(evt);
            }
        });

        jLabel18.setText("Sort By Day:");

        cbViewDay.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cbViewDayActionPerformed(evt);
            }
        });

        cbViewCategoryFilter.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cbViewCategoryFilterActionPerformed(evt);
            }
        });

        jLabel19.setText("Sort by Category:");

        jButton1.setText("Generate Report");

        javax.swing.GroupLayout ViewTransactionPanelLayout = new javax.swing.GroupLayout(ViewTransactionPanel);
        ViewTransactionPanel.setLayout(ViewTransactionPanelLayout);
        ViewTransactionPanelLayout.setHorizontalGroup(
            ViewTransactionPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(ViewTransactionPanelLayout.createSequentialGroup()
                .addGroup(ViewTransactionPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(ViewTransactionPanelLayout.createSequentialGroup()
                        .addGap(23, 23, 23)
                        .addGroup(ViewTransactionPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(ViewTransactionPanelLayout.createSequentialGroup()
                                .addComponent(jLabel15)
                                .addGap(18, 18, 18)
                                .addComponent(jLabel16, javax.swing.GroupLayout.PREFERRED_SIZE, 180, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(ViewTransactionPanelLayout.createSequentialGroup()
                                .addComponent(jLabel3, javax.swing.GroupLayout.PREFERRED_SIZE, 77, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(cbViewYearFilter, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(45, 45, 45)
                                .addComponent(jLabel17, javax.swing.GroupLayout.PREFERRED_SIZE, 77, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(cbViewMonth, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(29, 29, 29)
                                .addComponent(jLabel18, javax.swing.GroupLayout.PREFERRED_SIZE, 77, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(18, 18, 18)
                                .addComponent(cbViewDay, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(46, 46, 46)
                                .addComponent(jLabel19, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(cbViewCategoryFilter, javax.swing.GroupLayout.PREFERRED_SIZE, 109, javax.swing.GroupLayout.PREFERRED_SIZE))))
                    .addGroup(ViewTransactionPanelLayout.createSequentialGroup()
                        .addContainerGap()
                        .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 945, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap(180, Short.MAX_VALUE))
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, ViewTransactionPanelLayout.createSequentialGroup()
                .addGap(0, 0, Short.MAX_VALUE)
                .addComponent(jButton1, javax.swing.GroupLayout.PREFERRED_SIZE, 151, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(45, 45, 45))
        );
        ViewTransactionPanelLayout.setVerticalGroup(
            ViewTransactionPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(ViewTransactionPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(ViewTransactionPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel15, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel16))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(ViewTransactionPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel3)
                    .addComponent(cbViewYearFilter, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel17)
                    .addComponent(cbViewMonth, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel18)
                    .addComponent(cbViewDay, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(cbViewCategoryFilter, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel19))
                .addGap(37, 37, 37)
                .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 294, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 41, Short.MAX_VALUE)
                .addComponent(jButton1)
                .addGap(39, 39, 39))
        );

        TransactionModulesPanel.add(ViewTransactionPanel, "card4");

        jLabel20.setFont(new java.awt.Font("Yu Gothic UI", 1, 14)); // NOI18N
        jLabel20.setText("Transaction Manager :");

        jLabel21.setText("Update Transactions Module");

        jLabel22.setText("Sort By Year:");

        jLabel23.setText("Sort By  Month:");

        cbUpdateYearFilter.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cbUpdateYearFilterActionPerformed(evt);
            }
        });

        cbUpdateMonth.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cbUpdateMonthActionPerformed(evt);
            }
        });

        cbUpdateDay.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cbUpdateDayActionPerformed(evt);
            }
        });

        cbUpdateCategoryFilter.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cbUpdateCategoryFilterActionPerformed(evt);
            }
        });

        jLabel24.setText("Sort by Category:");

        jLabel25.setText("Sort By Day:");

        tabelUpdateTransactions.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null},
                {null, null, null, null, null},
                {null, null, null, null, null},
                {null, null, null, null, null}
            },
            new String [] {
                "TransactionID", "Category", "Amount", "Transaction Date", "Description"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        tabelUpdateTransactions.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tabelUpdateTransactionsMouseClicked(evt);
            }
        });
        jScrollPane3.setViewportView(tabelUpdateTransactions);

        jLabel32.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        jLabel32.setText("Amount ");

        txtUpdateAmount.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N

        jLabel33.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        jLabel33.setText("Date Of Transaction: ");

        txtUpdateDate.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtUpdateDateActionPerformed(evt);
            }
        });
        DatePicker updateDatePicker= new DatePicker();
        updateDatePicker.setEditor(txtUpdateDate);  // Link JFormattedTextField to DatePicker
        updateDatePicker.setDateFormat("yyyy-MM-dd");  // Set date format for display
        updateDatePicker.setUsePanelOption(true);  // Enable options panel on date picker
        updateDatePicker.setCloseAfterSelected(true);  // Close popup after date selection
        updateDatePicker.setSelectedDate(LocalDate.now());

        jLabel34.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        jLabel34.setText("Description");

        txtUpdateDescription.setColumns(20);
        txtUpdateDescription.setRows(5);
        jScrollPane5.setViewportView(txtUpdateDescription);

        jLabel35.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        jLabel35.setText("Category: ");

        cbUpdateCategory.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Item 1", "Item 2", "Item 3", "Item 4" }));
        cbUpdateCategory.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cbUpdateCategoryActionPerformed(evt);
            }
        });

        btnUpdateTransaction.setBackground(new java.awt.Color(0, 102, 51));
        btnUpdateTransaction.setForeground(new java.awt.Color(255, 255, 255));
        btnUpdateTransaction.setText("Update");
        btnUpdateTransaction.setBorder(null);
        btnUpdateTransaction.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnUpdateTransactionActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout UpdateTransactionsPanelLayout = new javax.swing.GroupLayout(UpdateTransactionsPanel);
        UpdateTransactionsPanel.setLayout(UpdateTransactionsPanelLayout);
        UpdateTransactionsPanelLayout.setHorizontalGroup(
            UpdateTransactionsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(UpdateTransactionsPanelLayout.createSequentialGroup()
                .addGap(14, 14, 14)
                .addGroup(UpdateTransactionsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(UpdateTransactionsPanelLayout.createSequentialGroup()
                        .addComponent(jLabel20)
                        .addGap(18, 18, 18)
                        .addComponent(jLabel21, javax.swing.GroupLayout.PREFERRED_SIZE, 180, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(UpdateTransactionsPanelLayout.createSequentialGroup()
                        .addComponent(jLabel22, javax.swing.GroupLayout.PREFERRED_SIZE, 77, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(cbUpdateYearFilter, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(45, 45, 45)
                        .addComponent(jLabel23, javax.swing.GroupLayout.PREFERRED_SIZE, 77, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(cbUpdateMonth, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(29, 29, 29)
                .addComponent(jLabel25, javax.swing.GroupLayout.PREFERRED_SIZE, 77, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(cbUpdateDay, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(46, 46, 46)
                .addComponent(jLabel24, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(cbUpdateCategoryFilter, javax.swing.GroupLayout.PREFERRED_SIZE, 109, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, UpdateTransactionsPanelLayout.createSequentialGroup()
                .addGroup(UpdateTransactionsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(UpdateTransactionsPanelLayout.createSequentialGroup()
                        .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(jScrollPane3, javax.swing.GroupLayout.PREFERRED_SIZE, 1008, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(UpdateTransactionsPanelLayout.createSequentialGroup()
                        .addGap(59, 59, 59)
                        .addGroup(UpdateTransactionsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel32, javax.swing.GroupLayout.PREFERRED_SIZE, 107, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel34, javax.swing.GroupLayout.PREFERRED_SIZE, 121, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(37, 37, 37)
                        .addGroup(UpdateTransactionsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(UpdateTransactionsPanelLayout.createSequentialGroup()
                                .addComponent(txtUpdateAmount, javax.swing.GroupLayout.PREFERRED_SIZE, 124, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(37, 37, 37)
                                .addComponent(jLabel33, javax.swing.GroupLayout.PREFERRED_SIZE, 190, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(txtUpdateDate, javax.swing.GroupLayout.PREFERRED_SIZE, 129, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 95, Short.MAX_VALUE)
                                .addComponent(jLabel35, javax.swing.GroupLayout.PREFERRED_SIZE, 95, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(18, 18, 18)
                                .addComponent(cbUpdateCategory, javax.swing.GroupLayout.PREFERRED_SIZE, 193, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(UpdateTransactionsPanelLayout.createSequentialGroup()
                                .addComponent(jScrollPane5, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(369, 369, 369)
                                .addComponent(btnUpdateTransaction, javax.swing.GroupLayout.PREFERRED_SIZE, 172, javax.swing.GroupLayout.PREFERRED_SIZE)))))
                .addGap(27, 27, 27))
        );
        UpdateTransactionsPanelLayout.setVerticalGroup(
            UpdateTransactionsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(UpdateTransactionsPanelLayout.createSequentialGroup()
                .addGap(14, 14, 14)
                .addGroup(UpdateTransactionsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel20, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel21))
                .addGap(33, 33, 33)
                .addGroup(UpdateTransactionsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel22)
                    .addComponent(cbUpdateYearFilter, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel23)
                    .addComponent(cbUpdateMonth, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel25)
                    .addComponent(cbUpdateDay, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(cbUpdateCategoryFilter, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel24))
                .addGap(18, 18, 18)
                .addComponent(jScrollPane3, javax.swing.GroupLayout.DEFAULT_SIZE, 163, Short.MAX_VALUE)
                .addGap(18, 18, 18)
                .addGroup(UpdateTransactionsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(UpdateTransactionsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(txtUpdateDate, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jLabel35, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(cbUpdateCategory, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(UpdateTransactionsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabel32)
                        .addComponent(txtUpdateAmount, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jLabel33)))
                .addGroup(UpdateTransactionsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(UpdateTransactionsPanelLayout.createSequentialGroup()
                        .addGap(53, 53, 53)
                        .addComponent(jLabel34))
                    .addGroup(UpdateTransactionsPanelLayout.createSequentialGroup()
                        .addGap(42, 42, 42)
                        .addComponent(jScrollPane5, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, UpdateTransactionsPanelLayout.createSequentialGroup()
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btnUpdateTransaction, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addGap(47, 47, 47))
        );

        TransactionModulesPanel.add(UpdateTransactionsPanel, "card5");

        btnRemoveTransaction.setBackground(new java.awt.Color(255, 51, 51));
        btnRemoveTransaction.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        btnRemoveTransaction.setForeground(new java.awt.Color(255, 255, 255));
        btnRemoveTransaction.setText("Remove");
        btnRemoveTransaction.setBorder(null);
        btnRemoveTransaction.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnRemoveTransactionActionPerformed(evt);
            }
        });

        jLabel36.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        jLabel36.setText("Amount ");

        jLabel26.setText("Sort By  Month:");

        txtRemoveAmount.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N

        cbRemoveYearFilter.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cbRemoveYearFilterActionPerformed(evt);
            }
        });

        jLabel37.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        jLabel37.setText("Date Of Transaction: ");

        cbRemoveMonth.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cbRemoveMonthActionPerformed(evt);
            }
        });

        txtRemoveDate.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtRemoveDateActionPerformed(evt);
            }
        });
        dp.setEditor(txtUpdateDate);  // Link JFormattedTextField to DatePicker
        dp.setDateFormat("yyyy-MM-dd");  // Set date format for display
        dp.setUsePanelOption(true);  // Enable options panel on date picker
        dp.setCloseAfterSelected(true);  // Close popup after date selection
        dp.setSelectedDate(LocalDate.now());

        cbRemoveDay.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cbRemoveDayActionPerformed(evt);
            }
        });

        jLabel38.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        jLabel38.setText("Description");

        cbRemoveCategoryFilter.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cbRemoveCategoryFilterActionPerformed(evt);
            }
        });

        txtRemoveDescription.setColumns(20);
        txtRemoveDescription.setRows(5);
        jScrollPane6.setViewportView(txtRemoveDescription);

        jLabel27.setText("Sort by Category:");

        jLabel28.setText("Sort By Day:");

        jLabel39.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        jLabel39.setText("Category: ");

        tabelRemoveTransactions.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null},
                {null, null, null, null, null},
                {null, null, null, null, null},
                {null, null, null, null, null}
            },
            new String [] {
                "TransactionID", "Category", "Amount", "Transaction Date", "Description"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        tabelRemoveTransactions.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tabelRemoveTransactionsMouseClicked(evt);
            }
        });
        jScrollPane4.setViewportView(tabelRemoveTransactions);

        cbRemoveCategory.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cbRemoveCategoryActionPerformed(evt);
            }
        });

        jLabel29.setFont(new java.awt.Font("Yu Gothic UI", 1, 14)); // NOI18N
        jLabel29.setText("Transaction Manager :");

        jLabel30.setText("Remove Transactions Module");

        jLabel31.setText("Sort By Year:");

        javax.swing.GroupLayout RemoveTransactionPanelLayout = new javax.swing.GroupLayout(RemoveTransactionPanel);
        RemoveTransactionPanel.setLayout(RemoveTransactionPanelLayout);
        RemoveTransactionPanelLayout.setHorizontalGroup(
            RemoveTransactionPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(RemoveTransactionPanelLayout.createSequentialGroup()
                .addGap(14, 14, 14)
                .addGroup(RemoveTransactionPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(RemoveTransactionPanelLayout.createSequentialGroup()
                        .addComponent(jLabel29)
                        .addGap(18, 18, 18)
                        .addComponent(jLabel30, javax.swing.GroupLayout.PREFERRED_SIZE, 180, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(RemoveTransactionPanelLayout.createSequentialGroup()
                        .addComponent(jLabel31, javax.swing.GroupLayout.PREFERRED_SIZE, 77, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(cbRemoveYearFilter, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(45, 45, 45)
                        .addComponent(jLabel26, javax.swing.GroupLayout.PREFERRED_SIZE, 77, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(cbRemoveMonth, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(29, 29, 29)
                .addComponent(jLabel28, javax.swing.GroupLayout.PREFERRED_SIZE, 77, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(cbRemoveDay, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(46, 46, 46)
                .addComponent(jLabel27, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(cbRemoveCategoryFilter, javax.swing.GroupLayout.PREFERRED_SIZE, 109, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, RemoveTransactionPanelLayout.createSequentialGroup()
                .addGroup(RemoveTransactionPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(RemoveTransactionPanelLayout.createSequentialGroup()
                        .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(jScrollPane4, javax.swing.GroupLayout.PREFERRED_SIZE, 1008, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(RemoveTransactionPanelLayout.createSequentialGroup()
                        .addGap(59, 59, 59)
                        .addGroup(RemoveTransactionPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel36, javax.swing.GroupLayout.PREFERRED_SIZE, 107, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel38, javax.swing.GroupLayout.PREFERRED_SIZE, 121, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(37, 37, 37)
                        .addGroup(RemoveTransactionPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(RemoveTransactionPanelLayout.createSequentialGroup()
                                .addComponent(txtRemoveAmount, javax.swing.GroupLayout.PREFERRED_SIZE, 124, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(37, 37, 37)
                                .addComponent(jLabel37, javax.swing.GroupLayout.PREFERRED_SIZE, 190, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(txtRemoveDate, javax.swing.GroupLayout.PREFERRED_SIZE, 129, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 95, Short.MAX_VALUE)
                                .addComponent(jLabel39, javax.swing.GroupLayout.PREFERRED_SIZE, 95, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(18, 18, 18)
                                .addComponent(cbRemoveCategory, javax.swing.GroupLayout.PREFERRED_SIZE, 193, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(RemoveTransactionPanelLayout.createSequentialGroup()
                                .addComponent(jScrollPane6, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(369, 369, 369)
                                .addComponent(btnRemoveTransaction, javax.swing.GroupLayout.PREFERRED_SIZE, 172, javax.swing.GroupLayout.PREFERRED_SIZE)))))
                .addGap(27, 27, 27))
        );
        RemoveTransactionPanelLayout.setVerticalGroup(
            RemoveTransactionPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(RemoveTransactionPanelLayout.createSequentialGroup()
                .addGap(14, 14, 14)
                .addGroup(RemoveTransactionPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel29, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel30))
                .addGap(33, 33, 33)
                .addGroup(RemoveTransactionPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel31)
                    .addComponent(cbRemoveYearFilter, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel26)
                    .addComponent(cbRemoveMonth, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel28)
                    .addComponent(cbRemoveDay, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(cbRemoveCategoryFilter, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel27))
                .addGap(18, 18, 18)
                .addComponent(jScrollPane4, javax.swing.GroupLayout.DEFAULT_SIZE, 163, Short.MAX_VALUE)
                .addGap(18, 18, 18)
                .addGroup(RemoveTransactionPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(RemoveTransactionPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(txtRemoveDate, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jLabel39, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(cbRemoveCategory, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(RemoveTransactionPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabel36)
                        .addComponent(txtRemoveAmount, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jLabel37)))
                .addGroup(RemoveTransactionPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(RemoveTransactionPanelLayout.createSequentialGroup()
                        .addGap(53, 53, 53)
                        .addComponent(jLabel38))
                    .addGroup(RemoveTransactionPanelLayout.createSequentialGroup()
                        .addGap(42, 42, 42)
                        .addComponent(jScrollPane6, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, RemoveTransactionPanelLayout.createSequentialGroup()
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btnRemoveTransaction, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addGap(47, 47, 47))
        );

        DatePicker removeDatePicker= new DatePicker();
        removeDatePicker.setEditor(txtUpdateDate);  // Link JFormattedTextField to DatePicker
        removeDatePicker.setDateFormat("yyyy-MM-dd");  // Set date format for display
        removeDatePicker.setUsePanelOption(true);  // Enable options panel on date picker
        removeDatePicker.setCloseAfterSelected(true);  // Close popup after date selection
        removeDatePicker.setSelectedDate(LocalDate.now());

        TransactionModulesPanel.add(RemoveTransactionPanel, "card6");

        jLabel4.setText("Choose Operations: ");

        btnAddTransactionModule.setText("Add Transaction");
        btnAddTransactionModule.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnAddTransactionModuleActionPerformed(evt);
            }
        });

        btnViewTransactionModule.setText("View Transaction");
        btnViewTransactionModule.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnViewTransactionModuleActionPerformed(evt);
            }
        });

        btnUpdateTransactionPanel.setText("Update Trasaction");
        btnUpdateTransactionPanel.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnUpdateTransactionPanelActionPerformed(evt);
            }
        });

        btnRemoveTransactionModule.setText("Remove Trascation ");
        btnRemoveTransactionModule.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnRemoveTransactionModuleActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout TrascationChoicePanelLayout = new javax.swing.GroupLayout(TrascationChoicePanel);
        TrascationChoicePanel.setLayout(TrascationChoicePanelLayout);
        TrascationChoicePanelLayout.setHorizontalGroup(
            TrascationChoicePanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(TrascationChoicePanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel4, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(83, 83, 83)
                .addComponent(btnAddTransactionModule)
                .addGap(136, 136, 136)
                .addComponent(btnViewTransactionModule, javax.swing.GroupLayout.PREFERRED_SIZE, 138, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(100, 100, 100)
                .addComponent(btnUpdateTransactionPanel)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(btnRemoveTransactionModule)
                .addContainerGap())
        );
        TrascationChoicePanelLayout.setVerticalGroup(
            TrascationChoicePanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(TrascationChoicePanelLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(TrascationChoicePanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel4)
                    .addComponent(btnAddTransactionModule, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(btnUpdateTransactionPanel)
                    .addComponent(btnViewTransactionModule)
                    .addComponent(btnRemoveTransactionModule)))
        );

        javax.swing.GroupLayout TransactionPanelLayout = new javax.swing.GroupLayout(TransactionPanel);
        TransactionPanel.setLayout(TransactionPanelLayout);
        TransactionPanelLayout.setHorizontalGroup(
            TransactionPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(TransactionPanelLayout.createSequentialGroup()
                .addComponent(TrascationChoicePanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGap(140, 140, 140))
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, TransactionPanelLayout.createSequentialGroup()
                .addGap(16, 16, 16)
                .addComponent(TransactionModulesPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addContainerGap())
        );
        TransactionPanelLayout.setVerticalGroup(
            TransactionPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(TransactionPanelLayout.createSequentialGroup()
                .addGap(8, 8, 8)
                .addComponent(TrascationChoicePanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(TransactionModulesPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        mainPanel.add(TransactionPanel, "card2");

        cbAnalyzeYear.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Item 1", "Item 2", "Item 3", "Item 4" }));

        cbAnalyzeCategory.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Item 1", "Item 2", "Item 3", "Item 4" }));

        btnAnalyzeGenerateReport.setText("Bar Graph");
        btnAnalyzeGenerateReport.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnAnalyzeGenerateReportActionPerformed(evt);
            }
        });

        btnGeneratePieChart.setText("Pie Chart");
        btnGeneratePieChart.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnGeneratePieChartActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout AnalyticsNavigationPanelLayout = new javax.swing.GroupLayout(AnalyticsNavigationPanel);
        AnalyticsNavigationPanel.setLayout(AnalyticsNavigationPanelLayout);
        AnalyticsNavigationPanelLayout.setHorizontalGroup(
            AnalyticsNavigationPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(AnalyticsNavigationPanelLayout.createSequentialGroup()
                .addGap(134, 134, 134)
                .addComponent(cbAnalyzeYear, javax.swing.GroupLayout.PREFERRED_SIZE, 216, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 85, Short.MAX_VALUE)
                .addComponent(cbAnalyzeCategory, javax.swing.GroupLayout.PREFERRED_SIZE, 196, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(56, 56, 56)
                .addComponent(btnAnalyzeGenerateReport, javax.swing.GroupLayout.PREFERRED_SIZE, 139, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(113, 113, 113)
                .addComponent(btnGeneratePieChart, javax.swing.GroupLayout.PREFERRED_SIZE, 112, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(210, 210, 210))
        );
        AnalyticsNavigationPanelLayout.setVerticalGroup(
            AnalyticsNavigationPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(AnalyticsNavigationPanelLayout.createSequentialGroup()
                .addGap(28, 28, 28)
                .addGroup(AnalyticsNavigationPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(cbAnalyzeCategory)
                    .addComponent(cbAnalyzeYear, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(24, 24, 24))
            .addGroup(AnalyticsNavigationPanelLayout.createSequentialGroup()
                .addGap(15, 15, 15)
                .addGroup(AnalyticsNavigationPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnAnalyzeGenerateReport, javax.swing.GroupLayout.PREFERRED_SIZE, 50, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnGeneratePieChart, javax.swing.GroupLayout.PREFERRED_SIZE, 50, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        ChartDisplayPanel.setLayout(new java.awt.CardLayout());

        WelcomeAnalyticsPanel.setEnabled(false);

        jLabel40.setFont(new java.awt.Font("Segoe UI", 1, 24)); // NOI18N
        jLabel40.setForeground(new java.awt.Color(255, 255, 255));
        jLabel40.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel40.setIcon(new javax.swing.ImageIcon("C:\\Users\\user\\Downloads\\Analytics Module.jpg")); // NOI18N
        jLabel40.setText("<html>\n<h1>Welcome to Analytics Module: </h1>\n<p>Choose the Year and Category to gernerate Chart.</p></html>\n");
        jLabel40.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);

        javax.swing.GroupLayout WelcomeAnalyticsPanelLayout = new javax.swing.GroupLayout(WelcomeAnalyticsPanel);
        WelcomeAnalyticsPanel.setLayout(WelcomeAnalyticsPanelLayout);
        WelcomeAnalyticsPanelLayout.setHorizontalGroup(
            WelcomeAnalyticsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(WelcomeAnalyticsPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel40, javax.swing.GroupLayout.PREFERRED_SIZE, 1145, Short.MAX_VALUE)
                .addContainerGap())
        );
        WelcomeAnalyticsPanelLayout.setVerticalGroup(
            WelcomeAnalyticsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(WelcomeAnalyticsPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel40, javax.swing.GroupLayout.PREFERRED_SIZE, 426, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        ChartDisplayPanel.add(WelcomeAnalyticsPanel, "card2");

        jLabel41.setFont(new java.awt.Font("Segoe UI", 3, 48)); // NOI18N
        jLabel41.setForeground(new java.awt.Color(0, 204, 255));
        jLabel41.setText("The Chart Is Generating Please Wait.....");

        javax.swing.GroupLayout ProgressBarPanelLayout = new javax.swing.GroupLayout(ProgressBarPanel);
        ProgressBarPanel.setLayout(ProgressBarPanelLayout);
        ProgressBarPanelLayout.setHorizontalGroup(
            ProgressBarPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(ProgressBarPanelLayout.createSequentialGroup()
                .addGap(116, 116, 116)
                .addGroup(ProgressBarPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jLabel41, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(pbAnaylyticsChartProgress, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap(159, Short.MAX_VALUE))
        );
        ProgressBarPanelLayout.setVerticalGroup(
            ProgressBarPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(ProgressBarPanelLayout.createSequentialGroup()
                .addGap(138, 138, 138)
                .addComponent(jLabel41)
                .addGap(42, 42, 42)
                .addComponent(pbAnaylyticsChartProgress, javax.swing.GroupLayout.PREFERRED_SIZE, 43, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(136, Short.MAX_VALUE))
        );

        ChartDisplayPanel.add(ProgressBarPanel, "card3");

        javax.swing.GroupLayout AnalyticsMainChartPanelLayout = new javax.swing.GroupLayout(AnalyticsMainChartPanel);
        AnalyticsMainChartPanel.setLayout(AnalyticsMainChartPanelLayout);
        AnalyticsMainChartPanelLayout.setHorizontalGroup(
            AnalyticsMainChartPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 1157, Short.MAX_VALUE)
        );
        AnalyticsMainChartPanelLayout.setVerticalGroup(
            AnalyticsMainChartPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 423, Short.MAX_VALUE)
        );

        ChartDisplayPanel.add(AnalyticsMainChartPanel, "card4");

        javax.swing.GroupLayout AnalyticsPanelLayout = new javax.swing.GroupLayout(AnalyticsPanel);
        AnalyticsPanel.setLayout(AnalyticsPanelLayout);
        AnalyticsPanelLayout.setHorizontalGroup(
            AnalyticsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(AnalyticsPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(ChartDisplayPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
            .addGroup(AnalyticsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, AnalyticsPanelLayout.createSequentialGroup()
                    .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(AnalyticsNavigationPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
        );
        AnalyticsPanelLayout.setVerticalGroup(
            AnalyticsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(AnalyticsPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(ChartDisplayPanel, javax.swing.GroupLayout.PREFERRED_SIZE, 423, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(113, Short.MAX_VALUE))
            .addGroup(AnalyticsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, AnalyticsPanelLayout.createSequentialGroup()
                    .addContainerGap(460, Short.MAX_VALUE)
                    .addComponent(AnalyticsNavigationPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addContainerGap(8, Short.MAX_VALUE)))
        );

        mainPanel.add(AnalyticsPanel, "card4");

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(NavigationPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            .addGroup(layout.createSequentialGroup()
                .addComponent(ButtonPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(mainPanel, javax.swing.GroupLayout.PREFERRED_SIZE, 1153, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                .addComponent(NavigationPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(mainPanel, javax.swing.GroupLayout.PREFERRED_SIZE, 542, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(ButtonPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void updateUserInfo() {
        // Assuming you have JLabels or other UI components to display user info
    txtUserName.setText("Username: " + loggedusername);
        txtUserID.setText("UserId: " + userId); 
    }
    private void btnAddTransactionActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnAddTransactionActionPerformed
         try {
                double amount = Double.parseDouble(txtAddAmount.getText());
                String description = txtAddDescription.getText();
                String category = cbAddCategory.getSelectedItem().toString();
                java.sql.Date transactionDate = java.sql.Date.valueOf(txtAddDatePicked.getText());

                Transaction transaction = new Transaction(0, amount, description, category, transactionDate,loggedInUserId);
                transactionDAO.addTransaction(transaction);
                JOptionPane.showMessageDialog(this, "Transaction added!");
                
            } catch (SQLException | NumberFormatException ex) {
                JOptionPane.showMessageDialog(this, "Error: " + ex.getMessage());
            }       // TODO add your handling code here:
    }//GEN-LAST:event_btnAddTransactionActionPerformed

    private void btnShowTransactionModuleActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnShowTransactionModuleActionPerformed
                // TODO add your handling code here:
                mainPanel.removeAll(); // Remove all components from mainPanel
                mainPanel.add(TransactionPanel); // Add the TransactionPanel to mainPanel
                mainPanel.revalidate(); // Revalidate the mainPanel to refresh the layout
                mainPanel.repaint(); 
    }//GEN-LAST:event_btnShowTransactionModuleActionPerformed

    private void btnAddTransactionModuleActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnAddTransactionModuleActionPerformed
                // TODO add your handling code here:
                populateCategoryComboBox(cbAddCategory);
                TransactionModulesPanel.removeAll();
                TransactionModulesPanel.add(AddTransactionPanel); // Add the TransactionPanel to mainPanel
                TransactionModulesPanel.revalidate(); // Revalidate the mainPanel to refresh the layout
                TransactionModulesPanel.repaint();
    }//GEN-LAST:event_btnAddTransactionModuleActionPerformed

    private void btnViewTransactionModuleActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnViewTransactionModuleActionPerformed
                    // TODO add your handling code here:
                     populateCategoryComboBox(cbViewCategoryFilter);  
                    loadTransactionsToTable(tabelViewAllTransactions);

                    
                TransactionModulesPanel.removeAll();
                TransactionModulesPanel.add(ViewTransactionPanel); // Add the TransactionPanel to mainPanel
                TransactionModulesPanel.revalidate(); // Revalidate the mainPanel to refresh the layout
                TransactionModulesPanel.repaint();
    }//GEN-LAST:event_btnViewTransactionModuleActionPerformed

    private void btnLogoutSessionActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnLogoutSessionActionPerformed
            // TODO add your handling code here:
             this.dispose();

    // Show the LoginForm again
    LoginForm loginForm = new LoginForm((userId, username) -> {
    UserSession.getInstance().setUserId(userId);
    MainDashboardForm mainDB = new MainDashboardForm(username, userId);
    mainDB.setVisible(true);
});
       loginForm.setVisible(true);
    }//GEN-LAST:event_btnLogoutSessionActionPerformed

    private void txtAddDatePickedActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtAddDatePickedActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtAddDatePickedActionPerformed

    private void cbAddCategoryActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cbAddCategoryActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_cbAddCategoryActionPerformed

    private void cbViewYearFilterActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cbViewYearFilterActionPerformed
        // TODO add your handling code here:
        filterTransactions(tabelViewAllTransactions,cbViewYearFilter,cbViewMonth,cbViewDay,cbViewCategoryFilter);
    }//GEN-LAST:event_cbViewYearFilterActionPerformed

    private void cbViewMonthActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cbViewMonthActionPerformed
        filterTransactions(tabelViewAllTransactions,cbViewYearFilter,cbViewMonth,cbViewDay,cbViewCategoryFilter);        // TODO add your handling code here:
    }//GEN-LAST:event_cbViewMonthActionPerformed

    private void cbViewDayActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cbViewDayActionPerformed
        // TODO add your handling code here:
        filterTransactions(tabelViewAllTransactions,cbViewYearFilter,cbViewMonth,cbViewDay,cbViewCategoryFilter);
    }//GEN-LAST:event_cbViewDayActionPerformed

    private void cbViewCategoryFilterActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cbViewCategoryFilterActionPerformed
        filterTransactions(tabelViewAllTransactions,cbViewYearFilter,cbViewMonth,cbViewDay,cbViewCategoryFilter);   // TODO add your handling code here:
    }//GEN-LAST:event_cbViewCategoryFilterActionPerformed

    private void cbUpdateYearFilterActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cbUpdateYearFilterActionPerformed
        // TODO add your handling code here:
        filterTransactions(tabelUpdateTransactions,cbUpdateYearFilter,cbUpdateMonth,cbUpdateDay,cbUpdateCategoryFilter); 
    }//GEN-LAST:event_cbUpdateYearFilterActionPerformed

    private void cbUpdateMonthActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cbUpdateMonthActionPerformed
        // TODO add your handling code here:
        filterTransactions(tabelUpdateTransactions,cbUpdateYearFilter,cbUpdateMonth,cbUpdateDay,cbUpdateCategoryFilter); 
    }//GEN-LAST:event_cbUpdateMonthActionPerformed

    private void cbUpdateDayActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cbUpdateDayActionPerformed
        // TODO add your handling code here:
        filterTransactions(tabelUpdateTransactions,cbUpdateYearFilter,cbUpdateMonth,cbUpdateDay,cbUpdateCategoryFilter); 
    }//GEN-LAST:event_cbUpdateDayActionPerformed

    private void cbUpdateCategoryFilterActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cbUpdateCategoryFilterActionPerformed
        // TODO add your handling code here:
        filterTransactions(tabelUpdateTransactions,cbUpdateYearFilter,cbUpdateMonth,cbUpdateDay,cbUpdateCategoryFilter); 
    }//GEN-LAST:event_cbUpdateCategoryFilterActionPerformed

    private void txtUpdateDateActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtUpdateDateActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtUpdateDateActionPerformed

    private void cbUpdateCategoryActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cbUpdateCategoryActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_cbUpdateCategoryActionPerformed

    private void btnUpdateTransactionActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnUpdateTransactionActionPerformed
           
      
    // Retrieve the stored transaction ID
    int transactionId = (int) btnUpdateTransaction.getClientProperty("transactionId");
    if (transactionId == 0) {
        JOptionPane.showMessageDialog(null, "Please select a transaction to update.");
        return;
    }

    // Get updated values from fields
    String newDate = txtUpdateDate.getText();
    String newCategory = cbUpdateCategory.getSelectedItem().toString();
    double newAmount = Double.parseDouble(txtUpdateAmount.getText());
    String newDescription = txtUpdateDescription.getText();

    // Update query
    String query = "UPDATE transactions SET transaction_date = ?, category = ?, amount = ?, description = ? WHERE id = ?";
    String url = "jdbc:mysql://localhost:3306/personal_finance";
    String username = "root";
    String password = "mysql";

    try (Connection conn = DriverManager.getConnection(url, username, password);
         PreparedStatement pstmt = conn.prepareStatement(query)) {
        pstmt.setString(1, newDate);
        pstmt.setString(2, newCategory);
        pstmt.setDouble(3, newAmount);
        pstmt.setString(4, newDescription);
        pstmt.setInt(5, transactionId);

        int rowsUpdated = pstmt.executeUpdate();
        if (rowsUpdated > 0) {
            JOptionPane.showMessageDialog(null, "Transaction updated successfully!");
            loadTransactionsToTable(tabelUpdateTransactions); // Refresh table
        } else {
            JOptionPane.showMessageDialog(null, "Error updating transaction.");
        }
    } catch (SQLException e) {
        JOptionPane.showMessageDialog(null, "Database error: " + e.getMessage());
    }



    }//GEN-LAST:event_btnUpdateTransactionActionPerformed

    private void tabelUpdateTransactionsMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tabelUpdateTransactionsMouseClicked
        // TODO add your handling code here:
 int selectedRow = tabelUpdateTransactions.getSelectedRow();
if (selectedRow != -1) {
    int result = JOptionPane.showConfirmDialog(null, 
        "Are you sure you want to update this transaction?", 
        "Confirm Update", JOptionPane.YES_NO_OPTION);

    if (result == JOptionPane.YES_OPTION) {
        try {
            // Retrieve data from the selected row
            Object idObject = tabelUpdateTransactions.getValueAt(selectedRow, 0);
            Object categoryObject = tabelUpdateTransactions.getValueAt(selectedRow, 1);
            Object amountObject = tabelUpdateTransactions.getValueAt(selectedRow, 3);
            Object dateObject = tabelUpdateTransactions.getValueAt(selectedRow, 4);
            Object descriptionObject = tabelUpdateTransactions.getValueAt(selectedRow, 2);

            // Convert data to the correct types
            int transactionId = (idObject != null) ? Integer.parseInt(idObject.toString()) : 0;
            String category = (categoryObject != null) ? categoryObject.toString() : "";
            double amount = (amountObject != null) ? Double.parseDouble(amountObject.toString()) : 0.0;
            String date = (dateObject != null) ? dateObject.toString() : "";
            String description = (descriptionObject != null) ? descriptionObject.toString() : "";

            // Populate text fields
            txtUpdateDate.setText(date);
            txtUpdateAmount.setText(String.valueOf(amount));
            txtUpdateDescription.setText(description);

            // Find and set the category in the combo box
            int categoryIndex = -1;
            for (int i = 0; i < cbUpdateCategory.getItemCount(); i++) {
                if (cbUpdateCategory.getItemAt(i).equals(category)) {
                    categoryIndex = i;
                    break;
                }
            }
            if (categoryIndex != -1) {
                cbUpdateCategory.setSelectedIndex(categoryIndex);
            } else {
                JOptionPane.showMessageDialog(null, "Category not found in combo box.");
            }

            // Store transaction ID for update reference
            btnUpdateTransaction.putClientProperty("transactionId", transactionId);
                     
        } catch (NumberFormatException e) {
            JOptionPane.showMessageDialog(null, "Error parsing data: " + e.getMessage());
        } catch (Exception e) {
            JOptionPane.showMessageDialog(null, "Unexpected error: " + e.getMessage());
        }
    }
} else {
    JOptionPane.showMessageDialog(null, "No row selected.");
}



    }//GEN-LAST:event_tabelUpdateTransactionsMouseClicked

    private void btnUpdateTransactionPanelActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnUpdateTransactionPanelActionPerformed
        // TODO add your handling code here:
        populateCategoryComboBox(cbUpdateCategoryFilter);  
        loadTransactionsToTable(tabelUpdateTransactions); 
        populateCategoryComboBox(cbUpdateCategory);
        
        
          TransactionModulesPanel.removeAll();
                TransactionModulesPanel.add(UpdateTransactionsPanel); // Add the TransactionPanel to mainPanel
                TransactionModulesPanel.revalidate(); // Revalidate the mainPanel to refresh the layout
                TransactionModulesPanel.repaint();
    }//GEN-LAST:event_btnUpdateTransactionPanelActionPerformed

    private void btnRemoveTransactionActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnRemoveTransactionActionPerformed
   
   int transactionId = (int) btnRemoveTransaction.getClientProperty("transactionId");
    if (transactionId == 0) {
        JOptionPane.showMessageDialog(null, "Please select a transaction to delete.");
        return;
    }

    // Confirmation dialog
    int result = JOptionPane.showConfirmDialog(null, 
        "Are you sure you want to delete this transaction?", 
        "Confirm Delete", JOptionPane.YES_NO_OPTION);
    if (result != JOptionPane.YES_OPTION) {
        return; // If the user selects "No", exit the method
    }

    // Delete query
    String query = "DELETE FROM transactions WHERE id = ?";
    String url = "jdbc:mysql://localhost:3306/personal_finance";
    String username = "root";
    String password = "mysql";

    try (Connection conn = DriverManager.getConnection(url, username, password);
         PreparedStatement pstmt = conn.prepareStatement(query)) {
        
        // Set the transaction ID parameter for deletion
        pstmt.setInt(1, transactionId);

        // Execute delete operation
        int rowsDeleted = pstmt.executeUpdate();
        if (rowsDeleted > 0) {
            JOptionPane.showMessageDialog(null, "Transaction deleted successfully!");
            loadTransactionsToTable(tabelRemoveTransactions); // Refresh table to reflect deletion
            clearFieldsAfterDeletion(); // Clear fields after deletion
        } else {
            JOptionPane.showMessageDialog(null, "Error deleting transaction.");
        }
    } catch (SQLException e) {
        JOptionPane.showMessageDialog(null, "Database error: " + e.getMessage());
    }


    }//GEN-LAST:event_btnRemoveTransactionActionPerformed

    private void cbRemoveYearFilterActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cbRemoveYearFilterActionPerformed
        // TODO add your handling code here:
        filterTransactions(tabelRemoveTransactions,cbRemoveYearFilter,cbRemoveMonth,cbRemoveDay,cbRemoveCategoryFilter); 
    }//GEN-LAST:event_cbRemoveYearFilterActionPerformed

    private void cbRemoveMonthActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cbRemoveMonthActionPerformed
filterTransactions(tabelRemoveTransactions,cbRemoveYearFilter,cbRemoveMonth,cbRemoveDay,cbRemoveCategoryFilter);         // TODO add your handling code here:
    }//GEN-LAST:event_cbRemoveMonthActionPerformed

    private void txtRemoveDateActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtRemoveDateActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtRemoveDateActionPerformed

    private void cbRemoveDayActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cbRemoveDayActionPerformed
filterTransactions(tabelRemoveTransactions,cbRemoveYearFilter,cbRemoveMonth,cbRemoveDay,cbRemoveCategoryFilter);         // TODO add your handling code here:
    }//GEN-LAST:event_cbRemoveDayActionPerformed

    private void cbRemoveCategoryFilterActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cbRemoveCategoryFilterActionPerformed
filterTransactions(tabelRemoveTransactions,cbRemoveYearFilter,cbRemoveMonth,cbRemoveDay,cbRemoveCategoryFilter);         // TODO add your handling code here:
    }//GEN-LAST:event_cbRemoveCategoryFilterActionPerformed

    private void tabelRemoveTransactionsMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tabelRemoveTransactionsMouseClicked
                                                    
        // TODO add your handling code here:
 int selectedRow = tabelRemoveTransactions.getSelectedRow();
if (selectedRow != -1) {
    int result = JOptionPane.showConfirmDialog(null, 
        "Are you sure you want to Remove this transaction?", 
        "Confirm Update", JOptionPane.YES_NO_OPTION);

    if (result == JOptionPane.YES_OPTION) {
        try {
            // Retrieve data from the selected row
            Object idObject = tabelRemoveTransactions.getValueAt(selectedRow, 0);
            Object categoryObject = tabelRemoveTransactions.getValueAt(selectedRow, 1);
            Object amountObject = tabelRemoveTransactions.getValueAt(selectedRow, 3);
            Object dateObject = tabelRemoveTransactions.getValueAt(selectedRow, 4);
            Object descriptionObject = tabelRemoveTransactions.getValueAt(selectedRow, 2);

            // Convert data to the correct types
            int transactionId = (idObject != null) ? Integer.parseInt(idObject.toString()) : 0;
            String category = (categoryObject != null) ? categoryObject.toString() : "";
            double amount = (amountObject != null) ? Double.parseDouble(amountObject.toString()) : 0.0;
            String date = (dateObject != null) ? dateObject.toString() : "";
            String description = (descriptionObject != null) ? descriptionObject.toString() : "";

            // Populate text fields
            txtRemoveDate.setText(date);
            txtRemoveAmount.setText(String.valueOf(amount));
            txtRemoveDescription.setText(description);

            // Find and set the category in the combo box
            int categoryIndex = -1;
            for (int i = 0; i < cbRemoveCategory.getItemCount(); i++) {
                if (cbRemoveCategory.getItemAt(i).equals(category)) {
                    categoryIndex = i;
                    break;
                }
            }
            if (categoryIndex != -1) {
                cbRemoveCategory.setSelectedIndex(categoryIndex);
            } else {
                JOptionPane.showMessageDialog(null, "Category not found in combo box.");
            }

            // Store transaction ID for update reference
            btnRemoveTransaction.putClientProperty("transactionId", transactionId);
                     
        } catch (NumberFormatException e) {
            JOptionPane.showMessageDialog(null, "Error parsing data: " + e.getMessage());
        } catch (Exception e) {
            JOptionPane.showMessageDialog(null, "Unexpected error: " + e.getMessage());
        }
    }
} else {
    JOptionPane.showMessageDialog(null, "No row selected.");
}

        
            // TODO add your handling code here:
    }//GEN-LAST:event_tabelRemoveTransactionsMouseClicked

    private void cbRemoveCategoryActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cbRemoveCategoryActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_cbRemoveCategoryActionPerformed

    private void btnRemoveTransactionModuleActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnRemoveTransactionModuleActionPerformed
        // TODO add your handling code here:
         populateCategoryComboBox(cbRemoveCategoryFilter);  
        loadTransactionsToTable(tabelRemoveTransactions); 
        populateCategoryComboBox(cbRemoveCategory);
        
        
          TransactionModulesPanel.removeAll();
                TransactionModulesPanel.add(RemoveTransactionPanel); // Add the TransactionPanel to mainPanel
                TransactionModulesPanel.revalidate(); // Revalidate the mainPanel to refresh the layout
                TransactionModulesPanel.repaint();
    }//GEN-LAST:event_btnRemoveTransactionModuleActionPerformed

    private void btnAnalyzeGenerateReportActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnAnalyzeGenerateReportActionPerformed
        // TODO add your handling code here:
        // Get selected filters
    String selectedYearString = cbAnalyzeYear.getSelectedItem().toString();
    selectedAnalyzeYear = Integer.parseInt(selectedYearString);  // Assign to class-level variable

  // Assign to class-level variable
    
                                                        
    // Get selected filters
  
    selectedAnalyzeYear = Integer.parseInt(selectedYearString);  // Assign to class-level variable
    selectedAnalyzeCategory = cbAnalyzeCategory.getSelectedItem().toString();  // Assign to class-level variable
    
    // Show progress bar
    showProgressBar();

    // Start background task to fetch data and generate the Bar Chart
    SwingWorker<Void, Void> worker = new SwingWorker<Void, Void>() {
        private JPanel barChartPanel; // Store the bar chart panel

        @Override
        protected Void doInBackground() throws Exception {
            // Simulate incremental progress
            for (int i = 0; i <= 100; i += 20) {
                Thread.sleep(200);  // Simulate a delay for progress
                setProgress(i);  // Update progress bar incrementally
            }
            
            // Fetch the data and generate the bar chart
            barChartPanel = createBarChartPanel(selectedAnalyzeYear, selectedAnalyzeCategory);
            return null;
        }

        @Override
        protected void done() {
            // Once the task is complete, replace the progress bar with the bar chart
            hideProgressBar();
            if (barChartPanel != null) {
                ChartDisplayPanel.removeAll();
                ChartDisplayPanel.add(barChartPanel);
                ChartDisplayPanel.revalidate();
                ChartDisplayPanel.repaint();
            } else {
                JOptionPane.showMessageDialog(null, "Failed to generate the bar chart. Please try again.");
            }
        }
    };

    // Update the progress bar's progress as the task progresses
    worker.addPropertyChangeListener(evt1 -> {
        if ("progress".equals(evt1.getPropertyName())) {
            int progress = (Integer) evt1.getNewValue();
            pbAnaylyticsChartProgress.setValue(progress);
        }
    });

    // Execute the worker thread
    worker.execute();


    
    }//GEN-LAST:event_btnAnalyzeGenerateReportActionPerformed

    private void btnAnayliticsPanelActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnAnayliticsPanelActionPerformed
        // TODO add your handling code here:
                populateCategoryComboBox(cbAnalyzeCategory);
                mainPanel.removeAll(); // Remove all components from mainPanel
                mainPanel.add(AnalyticsPanel); // Add the TransactionPanel to mainPanel
                mainPanel.revalidate(); // Revalidate the mainPanel to refresh the layout
                mainPanel.repaint(); 
    }//GEN-LAST:event_btnAnayliticsPanelActionPerformed

    private void btnGeneratePieChartActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnGeneratePieChartActionPerformed
        // TODO add your handling code here:
                int selectedAnalyzeYear = Integer.parseInt(cbAnalyzeYear.getSelectedItem().toString());  // Assign to class-level variable

        // Get selected category as a string from the combo box
        String selectedAnalyzeCategory = cbAnalyzeCategory.getSelectedItem().toString();  // Assign to class-level variable                                     
    // Show the progress bar
    showProgressBar();

    // Disable the button to prevent multiple executions
    btnGeneratePieChart.setEnabled(false);

    // Start background task to generate Pie Chart
    SwingWorker<Void, Void> worker = new SwingWorker<Void, Void>() {
        private JPanel chartPanel;

        @Override
        protected Void doInBackground() throws Exception {
            // Simulate progress
            for (int i = 0; i <= 100; i += 20) {
                Thread.sleep(200);  // Simulate delay
                setProgress(i);  // Update progress
            }

            // Generate the chart panel with actual data
            chartPanel = createMonthlyExpenditurePieChart(selectedAnalyzeYear, selectedAnalyzeCategory);
            return null;
        }

        @Override
        protected void done() {
            // Once done, replace the progress bar with the chart
            pbAnaylyticsChartProgress.setVisible(false);
            btnGeneratePieChart.setEnabled(true); // Re-enable the button

            if (chartPanel != null) {
                ChartDisplayPanel.removeAll();
                ChartDisplayPanel.add(chartPanel);
                ChartDisplayPanel.revalidate();
                ChartDisplayPanel.repaint();
            } else {
                // Display a message if the chart failed to generate
                JOptionPane.showMessageDialog(null, "Failed to generate the chart. Please try again.");
            }
        }
    };

    // Add progress listener to update the progress bar
    worker.addPropertyChangeListener(evt1 -> {
        if ("progress".equals(evt1.getPropertyName())) {
            int progress = (Integer) evt1.getNewValue();
            pbAnaylyticsChartProgress.setValue(progress);
        }
    });

    // Execute the worker
    worker.execute();
    }//GEN-LAST:event_btnGeneratePieChartActionPerformed

    private void btnGenerateReportActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnGenerateReportActionPerformed
            // TODO add your handling code here:
           // Get selected year as a string from the combo box and parse it to an integer
        int selectedAnalyzeYear = Integer.parseInt(cbAnalyzeYear.getSelectedItem().toString());  // Assign to class-level variable

        // Get selected category as a string from the combo box
        String selectedAnalyzeCategory = cbAnalyzeCategory.getSelectedItem().toString();  // Assign to class-level variable

        // Try to generate the report using the selected year and category
        try {
            ReportGenerator reportGenerator = new ReportGenerator();
            reportGenerator.generatePdfWithBarChartAndInsights(selectedAnalyzeYear, selectedAnalyzeCategory, userId); // Pass year, category, and userId
        } catch (DocumentException | IOException ex) {
            ex.printStackTrace();
            JOptionPane.showMessageDialog(null, "Error generating PDF: " + ex.getMessage());
}

    }//GEN-LAST:event_btnGenerateReportActionPerformed

    private void btnAboutSoftwareandCreatorVisionActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnAboutSoftwareandCreatorVisionActionPerformed
showAboutDialog();        // TODO add your handling code here:
    }//GEN-LAST:event_btnAboutSoftwareandCreatorVisionActionPerformed

    /**
     * @param args the command line arguments
     */
  public static void main(String args[]) {
      Document d =new Document();
    /* Set the Nimbus look and feel */
    FlatMacDarkLaf.setup();

    //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
    /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
     * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
    //</editor-fold>

    /* Retrieve username and userId from UserSession */
    UserSession userSession = UserSession.getInstance();
    String username = userSession.getUsername();
    int userId = userSession.getUserId();

    /* Create and display the form */
    java.awt.EventQueue.invokeLater(new Runnable() {
        public void run() {
            new MainDashboardForm(username, userId).setVisible(true);
        }
    });
}


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JPanel AddTransactionPanel;
    private javax.swing.JPanel AnalyticsMainChartPanel;
    private javax.swing.JPanel AnalyticsNavigationPanel;
    private javax.swing.JPanel AnalyticsPanel;
    private javax.swing.JPanel ButtonPanel;
    private javax.swing.JPanel ChartDisplayPanel;
    private javax.swing.JPanel NavigationPanel;
    private javax.swing.JPanel ProgressBarPanel;
    private javax.swing.JPanel RemoveTransactionPanel;
    private javax.swing.JPanel TransactionModulesPanel;
    private javax.swing.JPanel TransactionPanel;
    private javax.swing.JPanel TrascationChoicePanel;
    private javax.swing.JPanel UpdateTransactionsPanel;
    private javax.swing.JPanel ViewTransactionPanel;
    private javax.swing.JPanel WelcomeAnalyticsPanel;
    private javax.swing.JPanel WelcomePanel;
    private javax.swing.JPanel WelcomePanelTrancationiModule;
    private javax.swing.JButton btnAboutSoftwareandCreatorVision;
    private javax.swing.JButton btnAddTransaction;
    private javax.swing.JButton btnAddTransactionModule;
    private javax.swing.JButton btnAnalyzeGenerateReport;
    private javax.swing.JButton btnAnayliticsPanel;
    private javax.swing.JButton btnGeneratePieChart;
    private javax.swing.JButton btnGenerateReport;
    private javax.swing.JButton btnLogoutSession;
    private javax.swing.JButton btnRemoveTransaction;
    private javax.swing.JButton btnRemoveTransactionModule;
    private javax.swing.JButton btnShowTransactionModule;
    private javax.swing.JButton btnUpdateTransaction;
    private javax.swing.JButton btnUpdateTransactionPanel;
    private javax.swing.JButton btnViewTransactionModule;
    private javax.swing.JComboBox<String> cbAddCategory;
    private javax.swing.JComboBox<String> cbAnalyzeCategory;
    private javax.swing.JComboBox<String> cbAnalyzeYear;
    private javax.swing.JComboBox<String> cbRemoveCategory;
    private javax.swing.JComboBox<String> cbRemoveCategoryFilter;
    private javax.swing.JComboBox<String> cbRemoveDay;
    private javax.swing.JComboBox<String> cbRemoveMonth;
    private javax.swing.JComboBox<String> cbRemoveYearFilter;
    private javax.swing.JComboBox<String> cbUpdateCategory;
    private javax.swing.JComboBox<String> cbUpdateCategoryFilter;
    private javax.swing.JComboBox<String> cbUpdateDay;
    private javax.swing.JComboBox<String> cbUpdateMonth;
    private javax.swing.JComboBox<String> cbUpdateYearFilter;
    private javax.swing.JComboBox<String> cbViewCategoryFilter;
    private javax.swing.JComboBox<String> cbViewDay;
    private javax.swing.JComboBox<String> cbViewMonth;
    private javax.swing.JComboBox<String> cbViewYearFilter;
    private javax.swing.JButton jButton1;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel11;
    private javax.swing.JLabel jLabel12;
    private javax.swing.JLabel jLabel13;
    private javax.swing.JLabel jLabel14;
    private javax.swing.JLabel jLabel15;
    private javax.swing.JLabel jLabel16;
    private javax.swing.JLabel jLabel17;
    private javax.swing.JLabel jLabel18;
    private javax.swing.JLabel jLabel19;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel20;
    private javax.swing.JLabel jLabel21;
    private javax.swing.JLabel jLabel22;
    private javax.swing.JLabel jLabel23;
    private javax.swing.JLabel jLabel24;
    private javax.swing.JLabel jLabel25;
    private javax.swing.JLabel jLabel26;
    private javax.swing.JLabel jLabel27;
    private javax.swing.JLabel jLabel28;
    private javax.swing.JLabel jLabel29;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel30;
    private javax.swing.JLabel jLabel31;
    private javax.swing.JLabel jLabel32;
    private javax.swing.JLabel jLabel33;
    private javax.swing.JLabel jLabel34;
    private javax.swing.JLabel jLabel35;
    private javax.swing.JLabel jLabel36;
    private javax.swing.JLabel jLabel37;
    private javax.swing.JLabel jLabel38;
    private javax.swing.JLabel jLabel39;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel40;
    private javax.swing.JLabel jLabel41;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JScrollPane jScrollPane3;
    private javax.swing.JScrollPane jScrollPane4;
    private javax.swing.JScrollPane jScrollPane5;
    private javax.swing.JScrollPane jScrollPane6;
    private javax.swing.JPanel mainPanel;
    private javax.swing.JProgressBar pbAnaylyticsChartProgress;
    private javax.swing.JTable tabelRemoveTransactions;
    private javax.swing.JTable tabelUpdateTransactions;
    private javax.swing.JTable tabelViewAllTransactions;
    private javax.swing.JTextField txtAddAmount;
    private javax.swing.JFormattedTextField txtAddDatePicked;
    private javax.swing.JTextArea txtAddDescription;
    private javax.swing.JTextField txtRemoveAmount;
    private javax.swing.JFormattedTextField txtRemoveDate;
    private javax.swing.JTextArea txtRemoveDescription;
    private javax.swing.JTextField txtUpdateAmount;
    private javax.swing.JFormattedTextField txtUpdateDate;
    private javax.swing.JTextArea txtUpdateDescription;
    private javax.swing.JLabel txtUserID;
    private javax.swing.JLabel txtUserName;
    // End of variables declaration//GEN-END:variables

//    private void sortTransactionsByDate(LocalDate selectedDate) {
//    try {
//        // Assuming TransactionDAO has been initialized
//        TransactionDAO transactionDAO = new TransactionDAO();
//        
//        // Fetch sorted transactions based on the selected date
//        List<Transaction> transactions = transactionDAO.getAllTransactions(UserSession.getInstance().getUserId(), "transaction_date", "ASC", selectedDate);
//
//        // Update the table with the sorted transactions
//        DefaultTableModel model = (DefaultTableModel) transactionTable.getModel();
//        model.setRowCount(0);  // Clear existing rows
//
//        // Add the transactions to the table
//        for (Transaction transaction : transactions) {
//            model.addRow(new Object[]{
//                transaction.getId(),
//                transaction.getUserId(),
//                transaction.getType(),
//                transaction.getCategory(),
//                transaction.getAmount(),
//                transaction.getTransactionDate(),
//                transaction.getDescription(),
//                transaction.getPaymentMethod(),
//                transaction.isRecurring()
//            });
//        }
//    } catch (SQLException e) {
//        e.printStackTrace();
//        JOptionPane.showMessageDialog(this, "Error fetching transactions: " + e.getMessage());
//    }
//}
    

    
    private JPanel createMonthlyExpenditurePieChart(int year, String category) {
    // Step 1: Fetch data
    Map<String, Double> monthlyExpenditure = fetchMonthlyExpenditureData(year, category);

    if (monthlyExpenditure.isEmpty()) {
        JOptionPane.showMessageDialog(null, "No data available for the selected filters.");
        return null;
    }

    // Step 2: Create dataset
    DefaultPieDataset dataset = new DefaultPieDataset();
    monthlyExpenditure.forEach(dataset::setValue);

    // Step 3: Create the pie chart
    JFreeChart pieChart = ChartFactory.createPieChart(
        "Monthly Expenditure for " + category + " (" + year + ")",
        dataset,
        true,  // Include legend
        true,  // Include tooltips
        false  // Do not generate URLs
    );

    // Step 4: Style the chart (optional)
    PiePlot plot = (PiePlot) pieChart.getPlot();
    plot.setCircular(true);
    plot.setLabelFont(new Font("SansSerif", Font.PLAIN, 12));
    plot.setLabelGap(0.02);

    // Step 5: Create a ChartPanel
    ChartPanel chartPanel = new ChartPanel(pieChart);
    chartPanel.setPreferredSize(new Dimension(600, 400));

    // Return the panel
    return chartPanel;
}

    private void createChartPanelPie(int year, String category) {
    Map<String, Double> expenditureData = fetchMonthlyExpenditureData(year, category);

    if (expenditureData.isEmpty()) {
        System.out.println("No data found for the given year and category!");
        JOptionPane.showMessageDialog(null, "No data available for the selected filters.");
        return;
    }

    DefaultPieDataset dataset = new DefaultPieDataset();
    expenditureData.forEach((month, total) -> {
        System.out.println("Adding to dataset: Month = " + month + ", Total = " + total);
        dataset.setValue(month, total);
    });

    JFreeChart pieChart = ChartFactory.createPieChart(
        "Monthly Expenditure Analysis (" + category + ", " + year + ")",
        dataset,
        true,
        true,
        false
    );

    ChartPanel chartPanel = new ChartPanel(pieChart);
    chartPanel.setPreferredSize(new Dimension(mainPanel.getWidth(), mainPanel.getHeight()));

    // Replace content in main panel
    mainPanel.removeAll();
    mainPanel.add(chartPanel);
    mainPanel.revalidate();
    mainPanel.repaint();
}

    
 private Map<String, Double> fetchMonthlyExpenditureData(int year, String category) {
    Map<String, Double> data = new HashMap<>();

    try (Connection conn = DriverManager.getConnection(
            "jdbc:mysql://localhost:3306/personal_finance", "root", "mysql");
         PreparedStatement pstmt = conn.prepareStatement(
             "SELECT MONTHNAME(transaction_date) AS month, SUM(amount) AS total " +
                 "FROM transactions " +
                 "WHERE YEAR(transaction_date) = ? AND category = ? " +
                 "GROUP BY MONTH(transaction_date), MONTHNAME(transaction_date) " +
                 "ORDER BY MONTH(transaction_date)")) {

        pstmt.setInt(1, year);
        pstmt.setString(2, category);
        ResultSet rs = pstmt.executeQuery();

        while (rs.next()) {
            String month = rs.getString("month");
            double total = rs.getDouble("total");
            data.put(month, total); // Add data to the map
        }

    } catch (SQLException e) {
        e.printStackTrace();
        JOptionPane.showMessageDialog(null, "Error fetching data: " + e.getMessage());
    }

    if (data.isEmpty()) {
        System.out.println("EXPENDITURE DATA IS NOT FOUND for the selected year and category.");
    } else {
        System.out.println("Fetched data: " + data);
    }

    return data;
}



    private void loadTransactionsToTable(JTable table) {
    String[] columnNames = {"Transaction ID","Category", "Description", "Amount", "Date"};

    // Create a table model with the column names and no initial rows
    DefaultTableModel model = new DefaultTableModel(columnNames, 0);

    try {
        // Retrieve transactions for the logged-in user
        List<Transaction> transactions = transactionDAO.getAllTransactions(loggedInUserId);

        // Populate the model with each transaction's details
        for (Transaction t : transactions) {
            Object[] rowData = {
                t.getId(),
                t.getCategory(),
                t.getDescription(),
                t.getAmount(),
                t.getTransactionDate()
            };
            model.addRow(rowData);
        }

        // Set the model to the JTable
        table.setModel(model);

    } catch (SQLException e) {
        e.printStackTrace();
        JOptionPane.showMessageDialog(frame, "Error retrieving transactions: " + e.getMessage());
    }
    
    }

    private void filterTransactions(JTable table,JComboBox cbyear,JComboBox cbmonth,JComboBox cbday,JComboBox cbcategory) {
    // Clear existing data from the table
    DefaultTableModel model = (DefaultTableModel) table.getModel();
    model.setRowCount(0); // Remove all rows

    // Get selected values from combo boxes and handle null values
    String selectedYear = (cbyear.getSelectedItem() != null) ? cbyear.getSelectedItem().toString() : "All";
    String selectedMonth = (cbmonth.getSelectedItem() != null) ? cbmonth.getSelectedItem().toString() : "All";
    String selectedDay = (cbday.getSelectedItem() != null) ? cbday.getSelectedItem().toString() : "All";
    String selectedCategory = (cbcategory.getSelectedItem() != null) ? cbcategory.getSelectedItem().toString() : "All";

    // Start building the SQL query for transactions
    StringBuilder query = new StringBuilder("SELECT id, transaction_date, category, amount, description FROM transactions WHERE 1=1");

    // Add conditions based on combo box selections
    if (!selectedYear.equals("All")) {
        query.append(" AND YEAR(transaction_date) = '").append(selectedYear).append("'");
    }
    if (!selectedMonth.equals("All")) {
        query.append(" AND MONTH(transaction_date) = '").append(selectedMonth).append("'");
    }
    if (!selectedDay.equals("All")) {
        query.append(" AND DAY(transaction_date) = '").append(selectedDay).append("'");
    }
    if (!selectedCategory.equals("All")) {
        query.append(" AND category = '").append(selectedCategory).append("'");
    }

    // Database connection details
    String url = "jdbc:mysql://localhost:3306/personal_finance";
    String username = "root";
    String password = "mysql";

    try (Connection conn = DriverManager.getConnection(url, username, password);
         Statement stmt = conn.createStatement();
         ResultSet rs = stmt.executeQuery(query.toString())) {

        // Iterate through the result set and add rows to the table model
        while (rs.next()) {
             String transactionId = rs.getString("id");
            String category = rs.getString("category");
             double amount = rs.getDouble("amount");
            String date = rs.getString("transaction_date");
             String description = rs.getString("description");
           
           

            // Add the row to the table model
            model.addRow(new Object[]{transactionId, category, description,amount, date});
        }
    } catch (SQLException e) {
        JOptionPane.showMessageDialog(null, "Error fetching data: " + e.getMessage());
    }
}

    private int[] getDistinctYears() {
    try {
        // Fetch distinct years from the database using the transactionDAO
        List<Integer> distinctYearsList = transactionDAO.getDistinctYears(UserSession.getInstance().getUserId());
        
        // Convert List<Integer> to int[] for use in the combo box
        int[] distinctYears = new int[distinctYearsList.size()];
        for (int i = 0; i < distinctYearsList.size(); i++) {
            distinctYears[i] = distinctYearsList.get(i);
        }
        
        return distinctYears;
    } catch (SQLException e) {
        e.printStackTrace();
        JOptionPane.showMessageDialog(this, "Error fetching distinct years: " + e.getMessage());
        return new int[0];  // Return an empty array in case of error
    }
}
    private void updateTransactionTable(List<Transaction> transactions) {
        DefaultTableModel model = (DefaultTableModel) tabelViewAllTransactions.getModel();
        model.setRowCount(0);  // Clear the current data

        // Add the filtered transactions
        for (Transaction transaction : transactions) {
            model.addRow(new Object[]{
                transaction.getId(),
                transaction.getAmount(),
                transaction.getDescription(),
                transaction.getCategory(),
                transaction.getTransactionDate(),
                transaction.getUserId()
            });
        }
    }

    // Inside your GUI class
 private void populateYearComboBox(String url, String username, String password,JComboBox cbname) {
    // Database query to get distinct years
    String yearQuery = "SELECT DISTINCT YEAR(transaction_date) AS year FROM transactions";
    
    try (Connection conn = DriverManager.getConnection(url, username, password);
         Statement stmt = conn.createStatement();
         ResultSet rs = stmt.executeQuery(yearQuery)) {
        cbname.removeAllItems();  // Clear existing items in the combo box
        cbname.addItem("All");  // Add "All" as an option to remove filter
        
        // Add distinct years to the combo box
        while (rs.next()) {
            cbname.addItem(rs.getString("year"));
        }
    } catch (SQLException e) {
        e.printStackTrace();
    }
}

private void populateMonthComboBox(String url, String username, String password,JComboBox cbname) {
    // Database query to get distinct months
    String monthQuery = "SELECT DISTINCT MONTH(transaction_date) AS month FROM transactions";
    
    try (Connection conn = DriverManager.getConnection(url, username, password);
         Statement stmt = conn.createStatement();
         ResultSet rs = stmt.executeQuery(monthQuery)) {
        cbname.removeAllItems();  // Clear existing items in the combo box
        cbname.addItem("All");  // Add "All" as an option to remove filter
        
        // Add distinct months to the combo box
        while (rs.next()) {
            cbname.addItem(rs.getString("month"));
        }
    } catch (SQLException e) {
        e.printStackTrace();
    }
}

private void populateDayComboBox(String url, String username, String password,JComboBox cbname) {
    // Database query to get distinct days
    String dayQuery = "SELECT DISTINCT DAY(transaction_date) AS day FROM transactions";
    
    try (Connection conn = DriverManager.getConnection(url, username, password);
         Statement stmt = conn.createStatement();
         ResultSet rs = stmt.executeQuery(dayQuery)) {
        cbname.removeAllItems();  // Clear existing items in the combo box
        cbname.addItem("All");  // Add "All" as an option to remove filter
        
        // Add distinct days to the combo box
        while (rs.next()) {
            cbname.addItem(rs.getString("day"));
        }
    } catch (SQLException e) {
        e.printStackTrace();
    }
}
public void populateCategoryComboBox(JComboBox<String> categoryComboBox) {
    // Clear any existing items
    categoryComboBox.removeAllItems();
    
    // List of categories to be added to the combo box
    String[] categories = {"All",
        "Income", "Salary", "Bonus", "Freelance Income", "Investments", "Gifts", "Interest",
        "Expenses", "Housing", "Rent/Mortgage", "Property Taxes", "Home Repairs", "Utilities", "Gas/Fuel",
        "Transportation", "Car Maintenance", "Public Transport", "Insurance", "Food", "Groceries", "Dining Out",
        "Snacks", "Coffee", "Healthcare", "Doctor Visits", "Health Insurance", "Medications", "Therapy", "Education",
        "Tuition Fees", "Books/Supplies", "Online Courses", "Entertainment", "Movies", "Concerts", "Hobbies", "Shopping",
        "Clothes", "Electronics", "Gadgets", "Insurance", "Life Insurance", "Health Insurance", "Miscellaneous", "Gifts",
        "Donations", "Savings/Investments", "Retirement Fund", "Emergency Fund", "Stocks/Investments", "Loans and Debts",
        "Loan Repayments", "Credit Card Payments", "Taxes", "Income Tax", "Property Tax", "Subscriptions", "Software Subscriptions",
        "Gym Membership", "Club Membership", "Other", "Miscellaneous Income", "Miscellaneous Expense"
    };

    // Add each category to the combo box
    for (String category : categories) {
        categoryComboBox.addItem(category);
    }
}

private void clearFieldsAfterDeletion() {
   
    txtRemoveDate.setText("");
    cbRemoveCategory.setSelectedIndex(0); // Reset to default category
    txtRemoveAmount.setText("");
    txtRemoveDescription.setText("");
}
    // Show the progress bar
private void showProgressBar() { 
    ChartDisplayPanel.removeAll();
    ChartDisplayPanel.add(ProgressBarPanel);
    ChartDisplayPanel.revalidate();
    ChartDisplayPanel.repaint();
    pbAnaylyticsChartProgress.setValue(0);  // Reset the progress bar
}

// Hide the progress bar and show the generated chart
private void hideProgressBar() {
    JPanel chartPanel = createChartPanel(selectedAnalyzeYear, selectedAnalyzeCategory);  // Use generated data for chart
    ChartDisplayPanel.removeAll();
    ChartDisplayPanel.add(chartPanel);
    ChartDisplayPanel.revalidate();
    ChartDisplayPanel.repaint();
}
private void HideProgressBar() {
    // Hide the progress bar
    pbAnaylyticsChartProgress.setVisible(false);

    // Ensure ChartDisplayPanel is updated
    ChartDisplayPanel.revalidate();
    ChartDisplayPanel.repaint();
}

//private void generateCategoryExpenseChart(int year, String category) {
//    // Fetch data based on the year and category
//    Map<String, Double> categoryData = getCategoryExpenseData(year, category);
//
//    // Create the dataset for the chart
//    DefaultCategoryDataset dataset = new DefaultCategoryDataset();
//    for (Map.Entry<String, Double> entry : categoryData.entrySet()) {
//        dataset.addValue(entry.getValue(), "Expenses", entry.getKey());
//    }
//
//    // Generate the chart
//    JFreeChart chart = createChart(dataset);
//
//    // Wrap the chart in a ChartPanel
//    ChartPanel chartPanel = new ChartPanel(chart);
//    chartPanel.setPreferredSize(new java.awt.Dimension(800, 600));
//    chartPanel.setMouseWheelEnabled(true);
//
//    // Add the chart panel to ChartDisplayPanel
//    ChartDisplayPanel.removeAll();
//    ChartDisplayPanel.add(chartPanel);
//    ChartDisplayPanel.revalidate();
//    ChartDisplayPanel.repaint();
//}
private Map<String, Double> getCategoryExpenseData(int year, String category) {
      // Initialize map with all months of the year and 0 expenses
  Map<String, Double> categoryData = new LinkedHashMap<>();
    String[] months = new java.text.DateFormatSymbols().getMonths();
    
    // Initialize the map with all months and set the expenses to 0 initially
    for (int i = 0; i < 12; i++) {
        categoryData.put(months[i], 0.0);
    }

    // Query to fetch category data for the specific year, user, and category, grouping by month
    String query = "SELECT MONTH(transaction_date) AS month_number, SUM(amount) AS total_expense "
                 + "FROM transactions "
                 + "WHERE YEAR(transaction_date) = ? AND category = ? AND user_id = ? "
                 + "GROUP BY month_number ORDER BY month_number";

    try (Connection conn = DriverManager.getConnection("jdbc:mysql://localhost:3306/personal_finance", "root", "mysql");
         PreparedStatement pstmt = conn.prepareStatement(query)) {

        pstmt.setInt(1, year);
        pstmt.setString(2, category);
        pstmt.setInt(3, userId);
        
        ResultSet rs = pstmt.executeQuery();
        while (rs.next()) {
            int monthNumber = rs.getInt("month_number");
            double totalExpense = rs.getDouble("total_expense");
            
            String monthName = months[monthNumber - 1];
            categoryData.put(monthName, totalExpense);
        }

    } catch (SQLException e) {
        JOptionPane.showMessageDialog(null, "Error retrieving data: " + e.getMessage());
    }

    return categoryData;
}
private JFreeChart createChart(DefaultCategoryDataset dataset) {
    JFreeChart chart = ChartFactory.createBarChart(
        "Category Expenses", "Year", "Amount", dataset, PlotOrientation.VERTICAL,
        true, true, false);

    CategoryPlot plot = chart.getCategoryPlot();
    plot.setDomainGridlinesVisible(true);
    plot.setRangeGridlinesVisible(true);
    return chart;
}
private JPanel createChartPanel(int year, String category) {
    // Step 1: Fetch data
    Map<String, Double> expenditureData = fetchMonthlyExpenditureData(year, category);
    if (expenditureData.isEmpty()) {
        JOptionPane.showMessageDialog(null, "No data available for the selected filters.");
        return null;
    }

    // Step 2: Create dataset and calculate insights
    DefaultPieDataset dataset = new DefaultPieDataset();
    String highestExpenseMonth = null;
    double highestExpenseValue = Double.MIN_VALUE;
    double totalExpenditure = 0;

    for (Map.Entry<String, Double> entry : expenditureData.entrySet()) {
        String month = entry.getKey();
        double value = entry.getValue();
        dataset.setValue(month, value);

        totalExpenditure += value;
        if (value > highestExpenseValue) {
            highestExpenseValue = value;
            highestExpenseMonth = month;
        }
    }

    double averageExpenditure = totalExpenditure / expenditureData.size();
    double highestExpensePercentage = (highestExpenseValue / totalExpenditure) * 100;

    // Step 3: Create the pie chart
    JFreeChart pieChart = ChartFactory.createPieChart(
        "Monthly Expenditure for " + category + " (" + year + ")", // Chart title
        dataset,                                                   // Dataset
        true,                                                      // Include legend
        true,                                                      // Include tooltips
        false                                                      // Do not generate URLs
    );

    // Step 4: Customize the chart
    PiePlot plot = (PiePlot) pieChart.getPlot();
    plot.setLabelFont(new Font("SansSerif", Font.PLAIN, 12));
    plot.setCircular(true);
    plot.setLabelGap(0.02);

    ChartPanel chartPanel = new ChartPanel(pieChart);
    chartPanel.setPreferredSize(new Dimension(500, 400));

    // Step 5: Create insights panel
    JPanel insightsPanel = new JPanel(new GridBagLayout());
    insightsPanel.setBorder(BorderFactory.createEmptyBorder(10, 10, 10, 10));

    GridBagConstraints gbc = new GridBagConstraints();
    gbc.fill = GridBagConstraints.HORIZONTAL;
    gbc.insets = new Insets(5, 5, 5, 5); // Add spacing between components
    gbc.gridx = 0; // Column
    gbc.anchor = GridBagConstraints.WEST;

    // Title
    JLabel titleLabel = new JLabel("Expenditure Analysis");
    titleLabel.setFont(new Font("SansSerif", Font.BOLD, 36));
    gbc.gridy = 0; // Row
    gbc.gridwidth = 2;
    insightsPanel.add(titleLabel, gbc);

    gbc.gridwidth = 1; // Reset width for following rows

    // Insights
    addInsight(insightsPanel, gbc, "Highest Expense Month:", highestExpenseMonth, 1);
    addInsight(insightsPanel, gbc, "Highest Amount:", String.format("%.2f", highestExpenseValue), 2);
    addInsight(insightsPanel, gbc, "Total Expenditure:", String.format("%.2f", totalExpenditure), 3);
    addInsight(insightsPanel, gbc, "Average Monthly Expenditure:", String.format("%.2f", averageExpenditure), 4);
    addInsight(insightsPanel, gbc, "Highest Month Percentage:", String.format("%.2f%%", highestExpensePercentage), 5);

    // Step 6: Create a composite panel
    JPanel mainPanel = new JPanel(new BorderLayout());
    mainPanel.add(chartPanel, BorderLayout.CENTER);  // Add chart to the center
    mainPanel.add(insightsPanel, BorderLayout.EAST); // Add insights to the right

    return mainPanel;
}

// Helper method to add insights to the panel
private void addInsight(JPanel panel, GridBagConstraints gbc, String label, String value, int row) {
    JLabel insightLabel = new JLabel(label);
    JLabel insightValue = new JLabel(value);

    insightLabel.setFont(new Font("SansSerif", Font.BOLD, 30));
    insightValue.setFont(new Font("SansSerif", Font.BOLD, 24));

    gbc.gridy = row;
    gbc.gridx = 0;
    panel.add(insightLabel, gbc);

    gbc.gridx = 1;
    panel.add(insightValue, gbc);
}


private void generatePdfWithChart(int year, String category, int userId) throws DocumentException, IOException {
    // Step 1: Fetch the chart and data for the year and category
    Map<String, Double> categoryData = getCategoryExpenseData(year, category);
    DefaultCategoryDataset dataset = new DefaultCategoryDataset();
    for (Map.Entry<String, Double> entry : categoryData.entrySet()) {
        dataset.addValue(entry.getValue(), "Expenses", entry.getKey());
    }

    JFreeChart chart = createChart(dataset);

    // Step 2: Capture the chart as an image
    BufferedImage chartImage = chart.createBufferedImage(800, 600);

    // Step 3: Set file path to save the PDF (specifying the file path explicitly)
    String filePath = "YearlyExpenseReport_" + year + "_" + category + ".pdf";
    
    // Step 4: Create PDF document
    Document document = new Document();
    PdfWriter writer = PdfWriter.getInstance(document, new FileOutputStream(filePath));
    document.open();

    // Step 5: Add report title
     com.itextpdf.text.Font font = FontFactory.getFont(FontFactory.TIMES_ROMAN, 16, Font.BOLD);
Paragraph title = new Paragraph("Yearly Expense Report for " + category + " (" + year + ")", font);
title.setAlignment(Element.ALIGN_CENTER);
document.add(title);
    // Add line break
    document.add(Chunk.NEWLINE);

    // Step 6: Add chart image to PDF
    Image chartPdfImage = Image.getInstance(writer.getDirectContent(), chartImage, 1);
    chartPdfImage.setAlignment(Image.ALIGN_CENTER);
    chartPdfImage.scaleToFit(500, 400);
    document.add(chartPdfImage);

    // Step 7: Add transaction details to the PDF
     ;
        Paragraph transactionDetailsTitle = new Paragraph("\nTransaction Details for " + category + " in " + year, font);
        document.add(transactionDetailsTitle);

    // Step 8: Retrieve transaction data
    String transactionQuery = "SELECT * FROM transactions WHERE YEAR(transaction_date) = ? AND category = ? AND user_id = ?";
    try (Connection conn = DriverManager.getConnection("jdbc:mysql://localhost:3306/personal_finance", "root", "mysql");
         PreparedStatement pstmt = conn.prepareStatement(transactionQuery)) {

        pstmt.setInt(1, year);
        pstmt.setString(2, category);
        pstmt.setInt(3, userId);

        ResultSet rs = pstmt.executeQuery();
        PdfPTable table = new PdfPTable(5); // 5 columns for date, description, amount, method, and month
        table.setWidthPercentage(100);
        table.addCell("Date");
        table.addCell("Description");
        table.addCell("Amount");
        table.addCell("Payment Method");
        table.addCell("Month");

        while (rs.next()) {
            table.addCell(rs.getString("transaction_date"));
            table.addCell(rs.getString("description"));
            table.addCell("" + rs.getString("amount"));
            table.addCell(rs.getString("payment_method"));
            table.addCell(rs.getString("month"));
        }

        document.add(table);

    } catch (SQLException e) {
        e.printStackTrace();
    }

    // Step 9: Close the document
    document.close();

    // Step 10: Notify the user
    JOptionPane.showMessageDialog(null, "PDF Report Generated Successfully!");

    // Step 11: Open the PDF file
    openPdf(filePath);
}

private void openPdf(String filePath) {
    try {
        // Open the generated PDF using the default system viewer
        File pdfFile = new File(filePath);
        if (pdfFile.exists()) {
            if (Desktop.isDesktopSupported()) {
                Desktop desktop = Desktop.getDesktop();
                desktop.open(pdfFile);
            } else {
                JOptionPane.showMessageDialog(null, "Desktop is not supported on your system.");
            }
        } else {
            JOptionPane.showMessageDialog(null, "PDF file does not exist.");
        }
    } catch (IOException e) {
        e.printStackTrace();
        JOptionPane.showMessageDialog(null, "Error opening PDF: " + e.getMessage());
    }
}
private JPanel createBarChartPanel(int year, String category) {
    // Step 1: Fetch data
    Map<String, Double> monthlyExpenditure = fetchMonthlyExpenditureData(year, category);

    if (monthlyExpenditure.isEmpty()) {
        JOptionPane.showMessageDialog(null, "No data available for the selected filters.");
        return null;
    }

    // Step 2: Create dataset for the bar chart and find insights
    DefaultCategoryDataset dataset = new DefaultCategoryDataset();
    String highestExpenseMonth = null;
    double highestExpenseValue = Double.MIN_VALUE;
    double totalExpenditure = 0;

    for (Map.Entry<String, Double> entry : monthlyExpenditure.entrySet()) {
        String month = entry.getKey();
        double total = entry.getValue();
        dataset.addValue(total, category, month);

        totalExpenditure += total;
        if (total > highestExpenseValue) {
            highestExpenseValue = total;
            highestExpenseMonth = month;
        }
    }

    double averageExpenditure = totalExpenditure / monthlyExpenditure.size();
    double highestExpensePercentage = (highestExpenseValue / totalExpenditure) * 100;

    // Step 3: Create the bar chart
    JFreeChart barChart = ChartFactory.createBarChart(
        "Monthly Expenditure for " + category + " (" + year + ")", // Chart title
        "Month",                                                  // Category axis label
        "Expenditure",                                            // Value axis label
        dataset,                                                  // Dataset
        PlotOrientation.VERTICAL,                                 // Orientation
        true,                                                     // Include legend
        true,                                                     // Include tooltips
        false                                                     // Do not generate URLs
    );

    // Step 4: Style the chart (optional)
    CategoryPlot plot = barChart.getCategoryPlot();
    plot.setDomainGridlinesVisible(true);
    plot.setRangeGridlinePaint(Color.BLACK);

    // Step 5: Create the ChartPanel
    ChartPanel chartPanel = new ChartPanel(barChart);
    chartPanel.setPreferredSize(new Dimension(500, 400));

    // Step 6: Format the label with detailed insights using GridBagLayout for better alignment
    JPanel labelPanel = new JPanel(new GridBagLayout());
    labelPanel.setBorder(BorderFactory.createEmptyBorder(10, 10, 10, 10)); // Add padding

    GridBagConstraints gbc = new GridBagConstraints();
    gbc.fill = GridBagConstraints.HORIZONTAL;
    gbc.insets = new Insets(5, 5, 5, 5); // Add spacing between components
    gbc.gridx = 0; // Column
    gbc.anchor = GridBagConstraints.WEST;

    if (highestExpenseMonth != null) {
        JLabel titleLabel = new JLabel("Expenditure Analysis");
        titleLabel.setFont(new Font("SansSerif", Font.BOLD, 36));
        gbc.gridy = 0; // Row
        gbc.gridwidth = 2;
        labelPanel.add(titleLabel, gbc);

        gbc.gridwidth = 1; // Reset width for following rows

        JLabel monthLabel = new JLabel("Highest Expense Month:");
        JLabel monthValue = new JLabel(highestExpenseMonth);
        monthLabel.setFont(new Font("SansSerif", Font.BOLD, 30));
        monthValue.setFont(new Font("SansSerif", Font.BOLD, 24));

        
        gbc.gridy = 1;
        gbc.gridx = 0;
        labelPanel.add(monthLabel, gbc);
        gbc.gridx = 1;
        labelPanel.add(monthValue, gbc);

        JLabel valueLabel = new JLabel("Highest Amount:");
        JLabel valueValue = new JLabel(String.format("%.2f", highestExpenseValue));
          valueLabel.setFont(new Font("SansSerif", Font.BOLD, 30));
        valueValue.setFont(new Font("SansSerif", Font.BOLD, 24));
        gbc.gridy = 2;
        gbc.gridx = 0;
        labelPanel.add(valueLabel, gbc);
        gbc.gridx = 1;
        labelPanel.add(valueValue, gbc);

        JLabel totalLabel = new JLabel("Total Expenditure:");
        JLabel totalValue = new JLabel(String.format("%.2f", totalExpenditure));
         totalLabel.setFont(new Font("SansSerif", Font.BOLD, 30));
        totalValue.setFont(new Font("SansSerif", Font.BOLD, 24));
        
        gbc.gridy = 3;
        gbc.gridx = 0;
        labelPanel.add(totalLabel, gbc);
        gbc.gridx = 1;
        labelPanel.add(totalValue, gbc);

        JLabel averageLabel = new JLabel("Average Monthly Expenditure:");
        JLabel averageValue = new JLabel(String.format("%.2f", averageExpenditure));
          averageLabel.setFont(new Font("SansSerif", Font.BOLD, 30));
        averageValue.setFont(new Font("SansSerif", Font.BOLD, 24));
        gbc.gridy = 4;
        gbc.gridx = 0;
        labelPanel.add(averageLabel, gbc);
        gbc.gridx = 1;
        labelPanel.add(averageValue, gbc);

        JLabel percentageLabel = new JLabel("Highest Month Percentage:");
        JLabel percentageValue = new JLabel(String.format("%.2f%%", highestExpensePercentage));
          percentageLabel.setFont(new Font("SansSerif", Font.BOLD, 30));
        percentageValue.setFont(new Font("SansSerif", Font.BOLD, 24));
        gbc.gridy = 5;
        gbc.gridx = 0;
        labelPanel.add(percentageLabel, gbc);
        gbc.gridx = 1;
        labelPanel.add(percentageValue, gbc);
    }

    // Step 7: Create a composite panel to arrange the chart and label side by side
    JPanel mainPanel = new JPanel(new BorderLayout());
    mainPanel.add(chartPanel, BorderLayout.CENTER); // Add chart to the center
    mainPanel.add(labelPanel, BorderLayout.EAST);  // Add label to the right

    return mainPanel;
}
private void showAboutDialog() {
    String aboutText = "<html>" +
            "<h1 style='text-align: center;'>About SmartFinance</h1>" +
            "<p><b>SmartFinance</b> is a cutting-edge personal finance management tool designed to help individuals track their expenses, manage budgets, and gain insights into their financial habits.</p>" +
            "<p>The software is developed with a vision to promote financial literacy and empower users to achieve their financial goals.</p>" +
            "<p><b>Creator's Vision:</b></p>" +
            "<p>As the creator of SmartFinance, my mission is to combine advanced technology with simplicity to offer a seamless and intuitive experience. I aim to make financial management accessible and enjoyable for everyone.</p>" +
            "<br><p style='text-align: center;'>Thank you for using SmartFinance!</p>" +
            "<p style='text-align: center;'><i> 2024 SmartFinance</i></p>" +
            "</html>";

    JLabel aboutLabel = new JLabel(aboutText);
    aboutLabel.setFont(new Font("SansSerif", Font.PLAIN, 14));
    aboutLabel.setBorder(BorderFactory.createEmptyBorder(10, 10, 10, 10));

    JOptionPane.showMessageDialog(null, aboutLabel, "About SmartFinance", JOptionPane.INFORMATION_MESSAGE);
}









}




